# CRUD 頁面統一化專案任務書
**專案編號**: CRUD-UNIFY-2025  
**建立時間**: 2025-09-11  
**負責人**: Claude AI Assistant  
**專案目標**: 將所有 CRUD 頁面統一使用 StandardDataListPage 架構，建立統一的彈窗和搜尋元件

---

## 📋 專案執行規則（必須嚴格遵循）

### 🔧 開發流程規則
1. **建置規則**: 每次完成修改只執行 `npm run build`，不執行 `npm run dev`
2. **部署規則**: 不主動進行線上部署和推送 GitHub，需明確指示才執行
3. **測試規則**: 每次完成一個任務，必須列出可能影響的測試點供人工驗證
4. **相容性規則**: 統一後要保留原本的視覺、操作方式、功能、顯示欄位、邏輯
5. **程式碼優化規則**: 除非是該欄位獨特的功能或需求才做地方調整，否則都在統一頁面做修改，不要忘記做統一頁面的目的，以適配更多頁面，節省程式碼
6. **任務追蹤規則**: 每次完成任務都要把該項目勾選已完成（✅）
7. **文檔更新規則**: 完成任務確認驗收後，在 CLAUDE.md 寫上統一頁面的指向和使用說明

---

## 🎯 專案概述

### 已完成的基礎建設 ✅
- StandardDataListPage 組件庫已建立
- useDataSearch Hook 統一搜尋邏輯  
- useCartOperations Hook 統一購物車操作
- BUSINESS_CONFIG 配置參數集中管理

### 已採用統一架構的頁面 ✅
- `materials/page.tsx` - 原料庫管理頁面
- `fragrances/page.tsx` - 香精庫管理頁面  
- `suppliers/page.tsx` - 供應商管理頁面

---

## 📊 Chapter 1: 統一彈窗元件開發

### 背景分析
現有 20+ 個 Dialog 元件各自獨立開發，表單驗證、提交邏輯、樣式不統一。MaterialDialog、SupplierDialog 等結構相似但重複開發。

### 1.1 StandardFormDialog 基礎組件開發
- [x] **任務 1.1.1**: 分析現有彈窗元件共同模式 ✅ 2025-01-11
  - 研究 MaterialDialog、SupplierDialog、ProductDialog 結構
  - 識別共同的表單欄位類型和驗證邏輯
  - 設計統一的配置介面

- [x] **任務 1.1.2**: 建立 StandardFormDialog 組件 ✅ 2025-01-11
  - 建立 `src/components/StandardFormDialog.tsx`
  - 支援動態表單欄位配置
  - 整合統一的驗證和提交邏輯
  - **測試點**: 基本彈窗開關、表單渲染、驗證訊息顯示

- [x] **任務 1.1.3**: 建立表單欄位類型庫 ✅ 2025-01-11
  - 建立 `src/components/form-fields/` 目錄
  - 實作常用欄位類型：TextInput、NumberInput、SelectInput、TextareaInput
  - **測試點**: 各類型欄位輸入、驗證、清除功能

### 1.2 現有彈窗遷移到統一架構
- [x] **任務 1.2.1**: 遷移 MaterialDialog ✅ 2025-01-11
  - 使用 StandardFormDialog 重構 MaterialDialog
  - 保持原有功能、欄位、驗證邏輯不變
  - **測試點**: 新增原料、編輯原料、表單驗證、供應商選擇、分類選擇

- [ ] **任務 1.2.2**: 遷移 SupplierDialog  
  - 使用 StandardFormDialog 重構 SupplierDialog
  - 保持原有功能、欄位、驗證邏輯不變
  - **測試點**: 新增供應商、編輯供應商、聯絡人選擇、表單驗證

- [ ] **任務 1.2.3**: 遷移 ProductDialog
  - 使用 StandardFormDialog 重構 ProductDialog
  - 保持原有功能、欄位、驗證邏輯不變
  - **測試點**: 新增產品、編輯產品、香精選擇、配方計算

---

## 📊 Chapter 2: 統一搜尋選擇元件開發

### 背景分析
供應商選擇、分類選擇等下拉選單重複開發，搜尋功能不一致。

### 2.1 SearchableSelect 組件開發
- [ ] **任務 2.1.1**: 建立 SearchableSelect 組件
  - 建立 `src/components/SearchableSelect.tsx`
  - 支援同步和異步資料載入
  - 整合搜尋、篩選、多選功能
  - **測試點**: 資料載入、搜尋過濾、選項選擇、清除功能

- [ ] **任務 2.1.2**: 建立預設資料提供者
  - 建立 `src/hooks/useSelectData.ts`
  - 實作供應商、分類、人員等常用資料提供者
  - **測試點**: 各資料來源載入、快取、錯誤處理

### 2.2 現有選擇器遷移
- [ ] **任務 2.2.1**: 替換表單中的供應商選擇器
  - 在所有彈窗中使用 SearchableSelect 替換供應商選擇
  - **測試點**: 供應商搜尋、選擇、清除功能

- [ ] **任務 2.2.2**: 替換表單中的分類選擇器  
  - 在所有彈窗中使用 SearchableSelect 替換分類選擇
  - **測試點**: 主分類選擇、細分分類聯動、搜尋功能

---

## 📊 Chapter 3: CRUD 頁面統一架構遷移

### 背景分析
3 個主要頁面需要遷移到 StandardDataListPage 架構，保持原有功能和視覺設計。

### 3.1 人員管理頁面遷移
- [ ] **任務 3.1.1**: 分析 personnel/page.tsx 現有功能
  - 識別權限管理、工時統計特殊需求
  - 記錄現有欄位、篩選器、操作按鈕

- [ ] **任務 3.1.2**: 遷移 personnel/page.tsx 到統一架構  
  - 使用 StandardDataListPage 重構頁面
  - 保持所有原有功能、欄位、操作邏輯
  - **測試點**: 人員清單、權限顯示、工時統計、搜尋篩選、新增編輯刪除

### 3.2 工單管理頁面遷移
- [ ] **任務 3.2.1**: 分析 work-orders/page.tsx 現有功能
  - 識別工單狀態管理、統計卡片特殊需求
  - 記錄現有欄位、篩選器、操作按鈕

- [ ] **任務 3.2.2**: 遷移 work-orders/page.tsx 到統一架構
  - 使用 StandardDataListPage 重構頁面
  - 保持工單狀態管理、工時記錄功能
  - **測試點**: 工單清單、狀態篩選、工時記錄、進度追蹤

### 3.3 採購管理頁面遷移
- [ ] **任務 3.3.1**: 分析 purchase-orders/page.tsx 現有功能
  - 識別訂單狀態管理、批量操作特殊需求
  - 記錄現有欄位、篩選器、操作按鈕

- [ ] **任務 3.3.2**: 遷移 purchase-orders/page.tsx 到統一架構
  - 使用 StandardDataListPage 重構頁面  
  - 保持訂單狀態流程、批量操作功能
  - **測試點**: 訂單清單、狀態篩選、批量操作、訂單詳情、狀態變更

---

## 📊 Chapter 4: 文檔更新和規範建立

### 4.1 CLAUDE.md 統一設計規範更新
- [ ] **任務 4.1.1**: 更新 CLAUDE.md - CRUD 頁面統一規範章節
  - 添加 StandardDataListPage 使用指引
  - 建立頁面遷移檢查清單  
  - 定義快速篩選標籤設計規範

- [ ] **任務 4.1.2**: 更新 CLAUDE.md - AI 助理開發規範章節
  - 建立優先使用統一組件的原則
  - 定義新頁面開發流程
  - 建立元件選擇決策樹

### 4.2 專案完成驗收
- [ ] **任務 4.2.1**: 全面測試驗證
  - 測試所有遷移頁面的完整功能
  - 驗證統一組件在不同場景的表現
  - 確認無功能回歸問題

- [ ] **任務 4.2.2**: 效能和代碼品質檢查
  - 執行 `npm run build` 確認無編譯錯誤
  - 檢查代碼重複度降低情況
  - 驗證統一組件的重用性

---

## 📈 專案進度追蹤

### 完成狀態統計
- **Chapter 1**: 4/6 任務完成 (66.7%) ⚡ 進行中
- **Chapter 2**: 0/4 任務完成 (0%) 
- **Chapter 3**: 0/6 任務完成 (0%) 
- **Chapter 4**: 0/4 任務完成 (0%) 

**總進度**: 4/20 任務完成 (20%)

---

## ⚠️ 重要提醒

每次執行任務時必須：
1. ✅ 只執行 `npm run build` 進行驗證
2. ✅ 列出完整的測試點清單
3. ✅ 確認保持原有功能和視覺不變  
4. ✅ 優先修改統一組件而非個別適配
5. ✅ 完成後更新任務狀態為已完成
6. ✅ 驗收通過後更新 CLAUDE.md 文檔

---

**下次更新**: 開始執行 Chapter 1 任務時更新進度