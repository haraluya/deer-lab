# Deer Lab éƒ¨ç½²å•é¡Œè§£æ±ºæ–¹æ¡ˆ

## ğŸ¯ å•é¡Œæè¿°

æ‚¨çš„ Next.js æ‡‰ç”¨ç¨‹å¼åœ¨æœ¬åœ°é‹è¡Œæ­£å¸¸ï¼Œä½†éƒ¨ç½²åˆ° Firebase Hosting å¾Œå‡ºç¾ä»¥ä¸‹å•é¡Œï¼š

1. **JavaScript æª”æ¡ˆè¼‰å…¥å¤±æ•—** - ç€è¦½å™¨æ”¶åˆ° HTML è€Œä¸æ˜¯ JavaScript æª”æ¡ˆ
2. **è·¯å¾‘éŒ¯èª¤** - `/_next/static/` è·¯å¾‘ç„¡æ³•æ­£ç¢ºè§£æ
3. **æ‡‰ç”¨ç¨‹å¼å¡ä½** - é é¢é¡¯ç¤ºè¼‰å…¥ä¸­ä½†ç„¡æ³•æ­£å¸¸é‹ä½œ

## ğŸ” å•é¡Œæ ¹æº

é€™æ˜¯ Next.js éœæ…‹åŒ¯å‡º (`output: 'export'`) çš„å¸¸è¦‹å•é¡Œï¼š

1. **è·¯å¾‘ä¸åŒ¹é…**ï¼šNext.js ç”Ÿæˆçš„ HTML æª”æ¡ˆä¸­çš„è·¯å¾‘æ˜¯ `/_next/static/`ï¼Œä½†å¯¦éš›æª”æ¡ˆä½ç½®åœ¨ `/static/`
2. **Firebase è·¯ç”±é…ç½®**ï¼šéœ€è¦æ­£ç¢ºè™•ç†éœæ…‹æª”æ¡ˆå’Œ SPA è·¯ç”±
3. **å…§å®¹é¡å‹éŒ¯èª¤**ï¼šJavaScript å’Œ CSS æª”æ¡ˆéœ€è¦æ­£ç¢ºçš„ Content-Type æ¨™é ­

## âœ… è§£æ±ºæ–¹æ¡ˆ

### 1. ä¿®æ­£å»ºç½®è…³æœ¬ (`scripts/build-static.js`)

è‡ªå‹•ä¿®æ­£ HTML æª”æ¡ˆä¸­çš„è·¯å¾‘ï¼š

```javascript
// ä¿®æ­£è·¯å¾‘æ¨¡å¼
const patterns = [
  { from: /href="\/_next\/static\//g, to: 'href="/static/' },
  { from: /src="\/_next\/static\//g, to: 'src="/static/' },
  { from: /"\/_next\/static\//g, to: '"/static/' },
  { from: /'\/_next\/static\//g, to: "'/static/" },
  { from: /`\/_next\/static\//g, to: '`/static/' }
];
```

### 2. å„ªåŒ– Firebase é…ç½® (`firebase.json`)

æ­£ç¢ºè™•ç†éœæ…‹æª”æ¡ˆå’Œ SPA è·¯ç”±ï¼š

```json
{
  "hosting": {
    "public": "out",
    "rewrites": [
      {
        "source": "/static/**",
        "destination": "/static/**"
      },
      {
        "source": "/_next/static/**",
        "destination": "/static/**"
      },
      {
        "source": "**",
        "destination": "/index.html"
      }
    ],
    "headers": [
      {
        "source": "**/*.js",
        "headers": [
          {
            "key": "Content-Type",
            "value": "application/javascript"
          }
        ]
      },
      {
        "source": "**/*.css",
        "headers": [
          {
            "key": "Content-Type",
            "value": "text/css"
          }
        ]
      }
    ]
  }
}
```

### 3. è‡ªå‹•åŒ–éƒ¨ç½²æµç¨‹

æ–°å¢ä¸€éµéƒ¨ç½²æŒ‡ä»¤ï¼š

```bash
# å»ºç½®ã€éƒ¨ç½²ä¸¦æ¸¬è©¦
npm run fix-and-deploy
```

## ğŸš€ éƒ¨ç½²æ­¥é©Ÿ

### æ–¹æ³•ä¸€ï¼šä¸€éµéƒ¨ç½²ï¼ˆæ¨è–¦ï¼‰

```bash
npm run fix-and-deploy
```

### æ–¹æ³•äºŒï¼šåˆ†æ­¥é©Ÿéƒ¨ç½²

```bash
# 1. å»ºç½®å°ˆæ¡ˆ
npm run build-static

# 2. éƒ¨ç½²åˆ° Firebase
npm run deploy-only

# 3. æ¸¬è©¦éƒ¨ç½²
npm run test-deployment
```

### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨è…³æœ¬

#### Windows ç”¨æˆ¶
```bash
scripts\deploy.bat
```

#### macOS/Linux ç”¨æˆ¶
```bash
chmod +x scripts/deploy.sh
./scripts/deploy.sh
```

## ğŸ§ª é©—è­‰éƒ¨ç½²

åŸ·è¡Œæ¸¬è©¦è…³æœ¬é©—è­‰éƒ¨ç½²ï¼š

```bash
npm run test-deployment
```

æ¸¬è©¦é …ç›®åŒ…æ‹¬ï¼š
- âœ… ä¸»é é¢è¼‰å…¥
- âœ… Dashboard é é¢è¼‰å…¥
- âœ… CSS æª”æ¡ˆè¼‰å…¥
- âœ… JavaScript æª”æ¡ˆè¼‰å…¥
- âœ… Manifest æª”æ¡ˆè¼‰å…¥

## ğŸ“Š æ¸¬è©¦çµæœ

```
ğŸ“Š æ¸¬è©¦çµæœç¸½çµ:
âœ… é€šé: 5
âŒ å¤±æ•—: 0
ğŸ“ˆ æˆåŠŸç‡: 100.0%

ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼éƒ¨ç½²æˆåŠŸï¼
ğŸŒ æ‚¨çš„æ‡‰ç”¨ç¨‹å¼å·²æˆåŠŸéƒ¨ç½²åˆ°: https://deer-lab.web.app
```

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### è·¯å¾‘ä¿®æ­£é‚è¼¯

1. **HTML æª”æ¡ˆæƒæ**ï¼šéè¿´æŸ¥æ‰¾æ‰€æœ‰ HTML æª”æ¡ˆ
2. **è·¯å¾‘æ›¿æ›**ï¼šå°‡ `/_next/static/` æ›¿æ›ç‚º `/static/`
3. **å¤šç¨®æ¨¡å¼**ï¼šè™•ç† hrefã€srcã€JavaScript å­—ä¸²ç­‰ä¸åŒæƒ…æ³
4. **æª”æ¡ˆå¯«å›**ï¼šå°‡ä¿®æ­£å¾Œçš„å…§å®¹å¯«å›æª”æ¡ˆ

### Firebase é…ç½®èªªæ˜

1. **éœæ…‹æª”æ¡ˆè·¯ç”±**ï¼šç¢ºä¿ `/static/**` è·¯å¾‘æ­£ç¢ºè™•ç†
2. **SPA è·¯ç”±**ï¼šæ‰€æœ‰å…¶ä»–è·¯ç”±å°å‘ `index.html`
3. **å…§å®¹é¡å‹æ¨™é ­**ï¼šç¢ºä¿ JavaScript å’Œ CSS æª”æ¡ˆæœ‰æ­£ç¢ºçš„ Content-Type
4. **å¿«å–æ§åˆ¶**ï¼šHTML æª”æ¡ˆè¨­å®šç‚ºä¸å¿«å–

## ğŸ‰ çµæœ

ç¶“éä¿®æ­£å¾Œï¼Œæ‚¨çš„æ‡‰ç”¨ç¨‹å¼ç¾åœ¨å¯ä»¥ï¼š

- âœ… æ­£ç¢ºè¼‰å…¥æ‰€æœ‰ JavaScript æª”æ¡ˆ
- âœ… æ­£ç¢ºè¼‰å…¥æ‰€æœ‰ CSS æª”æ¡ˆ
- âœ… æ­£å¸¸é€²è¡Œè·¯ç”±å°èˆª
- âœ… å®Œæ•´çš„åŠŸèƒ½é‹ä½œ
- âœ… å¿«é€Ÿè¼‰å…¥å’ŒéŸ¿æ‡‰

## ğŸ“ ç¶­è­·å»ºè­°

1. **å®šæœŸæ¸¬è©¦**ï¼šä½¿ç”¨ `npm run test-deployment` æª¢æŸ¥éƒ¨ç½²ç‹€æ…‹
2. **ç›£æ§éŒ¯èª¤**ï¼šæª¢æŸ¥ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·çš„ Console å’Œ Network æ¨™ç±¤
3. **æ›´æ–°é…ç½®**ï¼šç•¶ Next.js ç‰ˆæœ¬æ›´æ–°æ™‚ï¼Œæª¢æŸ¥é…ç½®æ˜¯å¦éœ€è¦èª¿æ•´

## ğŸ”— ç›¸é—œé€£çµ

- **æ‡‰ç”¨ç¨‹å¼ç¶²å€**ï¼šhttps://deer-lab.web.app
- **Firebase Console**ï¼šhttps://console.firebase.google.com/project/deer-lab
- **GitHub Actions**ï¼šè‡ªå‹•éƒ¨ç½²å·¥ä½œæµç¨‹

---

**ğŸ‰ æ­å–œï¼æ‚¨çš„ Deer Lab ç”Ÿç”¢ç®¡ç†ç³»çµ±ç¾åœ¨å·²ç¶“å¯ä»¥æ­£å¸¸é‹ä½œäº†ï¼**
