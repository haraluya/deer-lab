(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7821],{9943:function(e,r,s){Promise.resolve().then(s.bind(s,28647))},32660:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},67782:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},42208:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},44794:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},99397:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},15868:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},62720:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},18930:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});let t=(0,s(79205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},99376:function(e,r,s){"use strict";var t=s(35475);s.o(t,"useParams")&&s.d(r,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},28647:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return E}});var t=s(57437),a=s(2265),n=s(99376),l=s(5978),i=s(1850),o=s(46410),d=s(29501),c=s(13590),m=s(67119),u=s(14438),x=s(12381),h=s(74291),f=s(80670),p=s(40279),g=s(4317),j=s(15291),b=s(62720),N=s(44794);let y=m.Ry({name:m.Z_().min(2,{message:"系列名稱至少需要 2 個字元"}),code:m.Z_().min(1,{message:"系列代號為必填欄位"}),productType:m.Z_().min(1,{message:"產品類型為必填欄位"}),commonMaterialIds:m.IX(m.Z_()).optional()}),v=[{value:"罐裝油(BOT)",label:"罐裝油(BOT)"},{value:"一代棉芯煙彈(OMP)",label:"一代棉芯煙彈(OMP)"},{value:"一代陶瓷芯煙彈(OTP)",label:"一代陶瓷芯煙彈(OTP)"},{value:"五代陶瓷芯煙彈(FTP)",label:"五代陶瓷芯煙彈(FTP)"},{value:"其他(ETC)",label:"其他(ETC)"}];function w(e){let{isOpen:r,onOpenChange:s,onSeriesUpdate:n,seriesData:m}=e,[w,C]=(0,a.useState)(!1),[k,Z]=(0,a.useState)([]),A=!!m,D=(0,d.cI)({resolver:(0,c.F)(y),defaultValues:{name:"",code:"",productType:"其他(ETC)",commonMaterialIds:[]}});async function S(e){C(!0);let r=u.Am.loading(A?"正在更新系列...":"正在新增系列...");try{let t=(0,i.$C)();if(A){let s=(0,i.V1)(t,"updateProductSeries");await s({seriesId:m.id,...e}),u.Am.success("系列 ".concat(e.name," 已更新。"),{id:r})}else{let s=(0,i.V1)(t,"createProductSeries");await s(e),u.Am.success("系列 ".concat(e.name," 已建立。"),{id:r})}n(),s(!1)}catch(s){console.error("操作失敗:",s);let e=A?"更新系列失敗。":"新增系列失敗。";s instanceof Error&&(e=s.message),u.Am.error(e,{id:r})}finally{C(!1)}}return(0,a.useEffect)(()=>{r&&(async()=>{try{if(!o.db)throw Error("Firebase 未初始化");let e=(await (0,l.getDocs)((0,l.collection)(o.db,"materials"))).docs.map(e=>{let r=e.data(),s=r.category||"未分類",t=r.subCategory||"未分類";return{value:e.id,label:"".concat(r.name," [").concat(s,"] [").concat(t,"]"),category:s,subCategory:t,materialName:r.name}}).sort((e,r)=>e.category!==r.category?e.category.localeCompare(r.category,"zh-TW"):e.subCategory!==r.subCategory?e.subCategory.localeCompare(r.subCategory,"zh-TW"):e.materialName.localeCompare(r.materialName,"zh-TW"));Z(e)}catch(e){u.Am.error("讀取物料選項失敗。")}})()},[r]),(0,a.useEffect)(()=>{r&&m?D.reset({name:m.name||"",code:m.code||"",productType:m.productType||"其他(ETC)",commonMaterialIds:m.commonMaterials.map(e=>e.id)}):r&&!m&&D.reset({name:"",code:"",productType:"其他(ETC)",commonMaterialIds:[]})},[r,m,D]),(0,t.jsx)(h.Vq,{open:r,onOpenChange:s,children:(0,t.jsxs)(h.cZ,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(h.fK,{children:[(0,t.jsx)(h.$N,{className:"text-xl font-bold text-gray-800",children:A?"編輯產品系列":"新增產品系列"}),(0,t.jsx)(h.Be,{className:"text-gray-600",children:A?"修改產品系列的基本資訊和常用物料配置":"建立新的產品系列並配置常用物料"})]}),(0,t.jsx)(f.l0,{...D,children:(0,t.jsxs)("form",{onSubmit:D.handleSubmit(S),className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-6 p-6 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl border border-orange-200 shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-3 text-orange-800",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(b.Z,{className:"h-4 w-4 text-orange-600"})}),"基本資訊"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(f.Wi,{control:D.control,name:"name",render:e=>{let{field:r}=e;return(0,t.jsxs)(f.xJ,{children:[(0,t.jsx)(f.lX,{className:"text-sm font-semibold text-gray-700",children:"系列名稱 *"}),(0,t.jsx)(f.NI,{children:(0,t.jsx)(p.I,{placeholder:"例如：經典系列",className:"border-gray-300 focus:border-orange-500 focus:ring-orange-500",...r})}),(0,t.jsx)(f.zG,{})]})}}),(0,t.jsx)(f.Wi,{control:D.control,name:"code",render:e=>{let{field:r}=e;return(0,t.jsxs)(f.xJ,{children:[(0,t.jsx)(f.lX,{className:"text-sm font-semibold text-gray-700",children:"系列代號 *"}),(0,t.jsx)(f.NI,{children:(0,t.jsx)(p.I,{placeholder:"例如：CLASSIC",className:"border-gray-300 focus:border-orange-500 focus:ring-orange-500",...r})}),(0,t.jsx)(f.zG,{})]})}}),(0,t.jsx)(f.Wi,{control:D.control,name:"productType",render:e=>{let{field:r}=e;return(0,t.jsxs)(f.xJ,{children:[(0,t.jsx)(f.lX,{className:"text-sm font-semibold text-gray-700",children:"產品類型 *"}),(0,t.jsxs)(j.Ph,{onValueChange:r.onChange,value:r.value,children:[(0,t.jsx)(f.NI,{children:(0,t.jsx)(j.i4,{className:"border-gray-300 focus:border-orange-500 focus:ring-orange-500",children:(0,t.jsx)(j.ki,{placeholder:"選擇產品類型"})})}),(0,t.jsx)(j.Bw,{children:v.map(e=>(0,t.jsx)(j.Ql,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(f.zG,{})]})}})]})]}),(0,t.jsxs)("div",{className:"space-y-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-3 text-blue-800",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(N.Z,{className:"h-4 w-4 text-blue-600"})}),"通用材料"]}),(0,t.jsx)(f.Wi,{control:D.control,name:"commonMaterialIds",render:e=>{let{field:r}=e;return(0,t.jsxs)(f.xJ,{children:[(0,t.jsx)(f.lX,{className:"text-sm font-semibold text-gray-700",children:"選擇通用材料"}),(0,t.jsx)(g.N,{options:k,selected:r.value||[],onChange:r.onChange,placeholder:"選擇通用材料..."}),(0,t.jsx)(f.zG,{})]})}})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[(0,t.jsx)(x.z,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:w,children:"取消"}),(0,t.jsx)(x.z,{type:"submit",disabled:w,className:"bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),A?"更新中...":"建立中..."]}):(0,t.jsx)(t.Fragment,{children:A?"更新系列":"建立系列"})})]})]})})]})})}var C=s(25751),k=s(32660),Z=s(99397),A=s(67782),D=s(42208),S=s(15868),z=s(18930),P=s(33804),T=s(32060);function M(){let e=(0,n.useRouter)(),r=(0,n.useSearchParams)(),[s,d]=(0,a.useState)([]),[c,m]=(0,a.useState)(!0),[h,f]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),y=(0,a.useCallback)(async()=>{m(!0);try{if(!o.db)throw Error("Firebase 未初始化");let e=new Map;(await (0,l.getDocs)((0,l.collection)(o.db,"materials"))).forEach(r=>e.set(r.id,r.data().name));let r=await (0,l.getDocs)((0,l.collection)(o.db,"productSeries")),s=await (0,l.getDocs)((0,l.collection)(o.db,"products")),t=await Promise.all(r.docs.map(async r=>{let t=r.data(),a=(t.commonMaterials||[]).map(r=>e.get(r.id)||"未知物料"),n=s.docs.filter(e=>{var s;let t=e.data();return(null===(s=t.seriesRef)||void 0===s?void 0:s.id)===r.id});return{id:r.id,name:t.name,code:t.code,productType:t.productType||"其他(ETC)",commonMaterials:t.commonMaterials,materialNames:a,productCount:n.length,createdAt:t.createdAt,updatedAt:t.updatedAt}}));d(t)}catch(e){console.error("讀取產品系列資料失敗:",e),u.Am.error("讀取產品系列資料失敗。")}finally{m(!1)}},[]);(0,a.useEffect)(()=>{y()},[y]),(0,a.useEffect)(()=>{let t=r.get("edit");if(t&&s.length>0){let r=s.find(e=>e.id===t);r&&(N(r),f(!0),e.replace("/dashboard/product-series"))}},[r,s,e]);let v=()=>{N(null),f(!0)},M=e=>{N(e),f(!0)},E=e=>{N(e),g(!0)},R=r=>{e.push("/dashboard/product-series/".concat(r.id))},_=async()=>{if(!j)return;let e=u.Am.loading("正在刪除系列...");try{let r=(0,i.$C)(),s=(0,i.V1)(r,"deleteProductSeries");await s({seriesId:j.id}),u.Am.success("系列 ".concat(j.name," 已成功刪除。"),{id:e}),y()}catch(s){console.error("刪除系列失敗:",s);let r="刪除系列時發生錯誤。";s instanceof Error&&(r=s.message),u.Am.error(r,{id:e})}finally{g(!1),N(null)}};return(0,t.jsxs)("div",{className:"container mx-auto py-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,t.jsx)(x.z,{variant:"outline",size:"icon",onClick:()=>e.push("/dashboard/products"),className:"hover:bg-green-100 hover:border-green-300",children:(0,t.jsx)(k.Z,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:"產品系列管理"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"管理產品系列與常用物料配置"})]})]}),(0,t.jsx)("div",{className:"lg:hidden mb-6",children:(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)(x.z,{onClick:v,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,t.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),"新增系列"]})})}),(0,t.jsx)("div",{className:"hidden lg:block mb-6",children:(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:(0,t.jsxs)(x.z,{onClick:v,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,t.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),"新增系列"]})})}),(0,t.jsx)("div",{className:"lg:hidden",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden mb-6",children:[(0,t.jsx)("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-green-50 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4 text-green-600"}),(0,t.jsx)("h2",{className:"text-base font-semibold text-gray-800",children:"產品系列清單"})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:["共 ",s.length," 個"]})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsx)("div",{className:"min-w-full",children:c?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-10 h-10 border-4 border-green-200 rounded-full animate-spin"}),(0,t.jsx)("div",{className:"absolute top-0 left-0 w-10 h-10 border-4 border-transparent border-t-green-600 rounded-full animate-spin"})]}),(0,t.jsx)("span",{className:"mt-3 text-sm text-gray-600 font-medium",children:"載入中..."})]}):s.length>0?(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:s.map(e=>(0,t.jsxs)("div",{className:"p-4 hover:bg-green-100/60 transition-all duration-200 cursor-pointer border border-transparent hover:border-green-300 hover:shadow-md rounded-lg",onClick:()=>R(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:(0,t.jsx)(b.Z,{className:"h-4 w-4 text-white"})}),(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"font-medium text-gray-900 text-sm",children:e.name})})]}),(0,t.jsxs)(T.h_,{children:[(0,t.jsx)(T.$F,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,t.jsx)(x.z,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,t.jsx)(A.Z,{className:"h-4 w-4"})})}),(0,t.jsxs)(T.AW,{align:"end",children:[(0,t.jsxs)(T.Xi,{onClick:()=>R(e),children:[(0,t.jsx)(D.Z,{className:"mr-2 h-4 w-4"}),"查看詳細"]}),(0,t.jsxs)(T.Xi,{onClick:()=>M(e),children:[(0,t.jsx)(S.Z,{className:"mr-2 h-4 w-4"}),"編輯系列"]}),(0,t.jsx)(T.VD,{}),(0,t.jsxs)(T.Xi,{onClick:()=>E(e),className:"text-red-600",children:[(0,t.jsx)(z.Z,{className:"h-4 w-4 mr-2"}),"刪除系列"]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center gap-1 mb-1",children:(0,t.jsx)("span",{className:"text-gray-500",children:"類型"})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.productType})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center gap-1 mb-1",children:(0,t.jsx)("span",{className:"text-gray-500",children:"代號"})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.code})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center gap-1 mb-1",children:(0,t.jsx)("span",{className:"text-gray-500",children:"產品數量"})}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.productCount})]})]})]},e.id))}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-muted rounded-full flex items-center justify-center mb-3",children:(0,t.jsx)(b.Z,{className:"h-6 w-6 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"text-base font-medium text-foreground mb-1",children:"沒有產品系列資料"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4 text-center",children:"開始建立第一個產品系列來管理常用物料"}),(0,t.jsxs)(x.z,{onClick:v,variant:"outline",size:"sm",className:"border-green-200 text-green-600 hover:bg-green-50",children:[(0,t.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),"新增系列"]})]})})})]})}),(0,t.jsx)("div",{className:"hidden lg:block",children:(0,t.jsxs)("div",{className:"bg-card rounded-xl shadow-lg border border-border overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-background to-green-50 border-b border-border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"h-5 w-5 text-green-600"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"產品系列清單"})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["共 ",s.length," 個系列"]})]})}),(0,t.jsx)("div",{className:"table-responsive",children:(0,t.jsxs)(P.iA,{className:"table-enhanced",children:[(0,t.jsx)(P.xD,{children:(0,t.jsxs)(P.SC,{children:[(0,t.jsx)(P.ss,{className:"text-left",children:"產品資訊"}),(0,t.jsx)(P.ss,{className:"text-left",children:"類型"}),(0,t.jsx)(P.ss,{className:"text-left",children:"代號"}),(0,t.jsx)(P.ss,{className:"text-left",children:"產品數量"}),(0,t.jsx)(P.ss,{className:"text-right",children:"操作"})]})}),(0,t.jsx)(P.RM,{children:c?(0,t.jsx)(P.SC,{children:(0,t.jsx)(P.pj,{colSpan:5,className:"text-center py-16",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-12 h-12 border-4 border-green-200 rounded-full animate-spin"}),(0,t.jsx)("div",{className:"absolute top-0 left-0 w-12 h-12 border-4 border-transparent border-t-green-600 rounded-full animate-spin"})]}),(0,t.jsx)("span",{className:"mt-4 text-muted-foreground font-medium",children:"載入系列資料中..."})]})})}):s.length>0?s.map(e=>(0,t.jsxs)(P.SC,{className:"hover:bg-green-100/60 transition-all duration-200 cursor-pointer",onClick:()=>R(e),children:[(0,t.jsx)(P.pj,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:(0,t.jsx)(b.Z,{className:"h-5 w-5 text-white"})}),(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"font-semibold text-foreground",children:e.name})})]})}),(0,t.jsx)(P.pj,{children:(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.productType})}),(0,t.jsx)(P.pj,{children:(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.code})}),(0,t.jsx)(P.pj,{children:(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.productCount})}),(0,t.jsx)(P.pj,{className:"text-right",onClick:e=>e.stopPropagation(),children:(0,t.jsxs)(T.h_,{children:[(0,t.jsx)(T.$F,{asChild:!0,children:(0,t.jsxs)(x.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"開啟選單"}),(0,t.jsx)(A.Z,{className:"h-4 w-4"})]})}),(0,t.jsxs)(T.AW,{align:"end",children:[(0,t.jsx)(T.Ju,{children:"操作"}),(0,t.jsx)(T.VD,{}),(0,t.jsxs)(T.Xi,{onClick:()=>R(e),children:[(0,t.jsx)(D.Z,{className:"h-4 w-4 mr-2"}),"查看詳細"]}),(0,t.jsxs)(T.Xi,{onClick:()=>M(e),children:[(0,t.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"編輯系列"]}),(0,t.jsx)(T.VD,{}),(0,t.jsx)(T.Xi,{onClick:()=>E(e),className:"text-red-600 focus:text-red-600",children:"刪除系列"})]})]})})]},e.id)):(0,t.jsx)(P.SC,{children:(0,t.jsx)(P.pj,{colSpan:5,className:"text-center py-16",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)(b.Z,{className:"h-8 w-8 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"沒有產品系列資料"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"開始建立第一個產品系列來管理產品分類"}),(0,t.jsxs)(x.z,{onClick:v,variant:"outline",className:"border-green-200 text-green-600 hover:bg-green-50",children:[(0,t.jsx)(Z.Z,{className:"mr-2 h-4 w-4"}),"新增系列"]})]})})})})]})})]})}),(0,t.jsx)(w,{isOpen:h,onOpenChange:f,onSeriesUpdate:y,seriesData:j}),j&&(0,t.jsx)(C.Q,{isOpen:p,onOpenChange:g,onConfirm:_,title:"確認刪除系列",description:"您確定要永久刪除系列「".concat(j.name,"」嗎？此操作無法復原。")})]})}function E(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{children:"Loading..."}),children:(0,t.jsx)(M,{})})}},4317:function(e,r,s){"use strict";s.d(r,{N:function(){return i}});var t=s(57437),a=s(2265),n=s(32489),l=s(69174);function i(e){let{options:r,selected:s,onChange:i,onAddNew:o,placeholder:d="Select options...",className:c,allowCreate:m=!1}=e,[u,x]=a.useState(!1),[h,f]=a.useState(""),p=a.useRef(null),g=e=>{f(""),i([...s,e])},j=()=>{h.trim()&&o&&(o(h.trim()),f(""))},b=e=>{i(s.filter(r=>r!==e))},N=r.filter(e=>s.includes(e.value)),y=r.filter(e=>{if(s.includes(e.value))return!1;if(!h.trim())return!0;let r=h.trim().toLowerCase(),t=(e.materialName||e.label).toLowerCase(),a=(e.category||"").toLowerCase(),n=(e.subCategory||"").toLowerCase(),l=e.label.toLowerCase();return t.includes(r)||a.includes(r)||n.includes(r)||l.includes(r)}).sort((e,r)=>{let s=(e.materialName||e.label).toLowerCase(),t=(r.materialName||r.label).toLowerCase();return s.localeCompare(t,"zh-TW")});return(0,t.jsxs)("div",{className:"overflow-visible bg-transparent",children:[(0,t.jsx)("div",{className:"group border border-input px-3 py-2 text-sm ring-offset-background rounded-md focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:(0,t.jsxs)("div",{className:"flex gap-1 flex-wrap",children:[N.map(e=>{let{value:r,label:s,category:a,subCategory:i,materialName:o}=e;return(0,t.jsxs)(l.C,{variant:"secondary",className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"font-medium",children:o||s}),a&&(0,t.jsx)("span",{className:"px-1 py-0.5 text-xs rounded bg-blue-100 text-blue-800 font-medium",children:a}),i&&(0,t.jsx)("span",{className:"px-1 py-0.5 text-xs rounded bg-green-100 text-green-800 font-medium",children:i}),(0,t.jsx)("button",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:e=>{"Enter"===e.key&&b(r)},onMouseDown:e=>e.preventDefault(),onClick:()=>b(r),children:(0,t.jsx)(n.Z,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},r)}),(0,t.jsx)("input",{ref:p,type:"text",value:h,onChange:e=>{let r=e.target.value;f(r),r.trim()?x(!0):x(!1)},onKeyDown:e=>{"Backspace"===e.key&&""===h&&s.length>0&&b(s[s.length-1]),"Enter"===e.key&&h.trim()&&m&&o&&(e.preventDefault(),j())},onBlur:()=>{setTimeout(()=>x(!1),200)},onFocus:()=>{h.trim()&&x(!0)},placeholder:d,className:"ml-2 bg-transparent outline-none placeholder:text-muted-foreground flex-1"})]})}),(0,t.jsx)("div",{className:"relative mt-2",children:u&&(y.length>0||m&&h.trim())?(0,t.jsx)("div",{className:"absolute w-full z-10 top-0 rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in",children:(0,t.jsxs)("div",{className:"h-full overflow-auto",children:[y.map(e=>{let{value:r,label:s,category:a,subCategory:n,materialName:l}=e;return(0,t.jsx)("div",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:()=>g(r),className:"cursor-pointer px-2 py-3 hover:bg-accent hover:text-accent-foreground",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,t.jsx)("span",{className:"flex-1 font-medium",children:l||s}),a&&(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-100 text-blue-800 font-medium",children:a}),n&&(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-md bg-green-100 text-green-800 font-medium",children:n})]})},r)}),m&&h.trim()&&!y.find(e=>e.label.toLowerCase()===h.toLowerCase())&&(0,t.jsxs)("div",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:j,className:"cursor-pointer text-blue-600 px-2 py-3 hover:bg-accent hover:text-accent-foreground",children:['新增 "',h.trim(),'"']})]})}):null})]})}},15291:function(e,r,s){"use strict";s.d(r,{Bw:function(){return f},Ph:function(){return c},Ql:function(){return p},i4:function(){return u},ki:function(){return m}});var t=s(57437),a=s(2265),n=s(33911),l=s(40875),i=s(22135),o=s(30401),d=s(93448);let c=n.fC;n.ZA;let m=n.B4,u=a.forwardRef((e,r)=>{let{className:s,children:a,...i}=e;return(0,t.jsxs)(n.xz,{ref:r,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus:ring-slate-300",s),...i,children:[a,(0,t.jsx)(n.JO,{asChild:!0,children:(0,t.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.xz.displayName;let x=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(n.u_,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=n.u_.displayName;let h=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(n.$G,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,t.jsx)(l.Z,{className:"h-4 w-4"})})});h.displayName=n.$G.displayName;let f=a.forwardRef((e,r)=>{let{className:s,children:a,position:l="popper",...i}=e;return(0,t.jsx)(n.h_,{children:(0,t.jsxs)(n.VY,{ref:r,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-white text-slate-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,t.jsx)(x,{}),(0,t.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,t.jsx)(h,{})]})})});f.displayName=n.VY.displayName,a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(n.__,{ref:r,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=n.__.displayName;let p=a.forwardRef((e,r)=>{let{className:s,children:a,...l}=e;return(0,t.jsxs)(n.ck,{ref:r,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-slate-50",s),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(n.wU,{children:(0,t.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(n.eT,{children:a})]})});p.displayName=n.ck.displayName,a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(n.Z0,{ref:r,className:(0,d.cn)("-mx-1 my-1 h-px bg-slate-100 dark:bg-slate-800",s),...a})}).displayName=n.Z0.displayName},90277:function(e,r,s){"use strict";s.d(r,{$j:function(){return O},Dx:function(){return I},VY:function(){return R},aU:function(){return _},aV:function(){return E},dk:function(){return V},fC:function(){return P},h_:function(){return M},xz:function(){return T}});var t=s(2265),a=s(73966),n=s(98575),l=s(49027),i=s(6741),o=s(37053),d=s(57437),c="AlertDialog",[m,u]=(0,a.b)(c,[l.p8]),x=(0,l.p8)(),h=e=>{let{__scopeAlertDialog:r,...s}=e,t=x(r);return(0,d.jsx)(l.fC,{...t,...s,modal:!0})};h.displayName=c;var f=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,...t}=e,a=x(s);return(0,d.jsx)(l.xz,{...a,...t,ref:r})});f.displayName="AlertDialogTrigger";var p=e=>{let{__scopeAlertDialog:r,...s}=e,t=x(r);return(0,d.jsx)(l.h_,{...t,...s})};p.displayName="AlertDialogPortal";var g=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,...t}=e,a=x(s);return(0,d.jsx)(l.aV,{...a,...t,ref:r})});g.displayName="AlertDialogOverlay";var j="AlertDialogContent",[b,N]=m(j),y=(0,o.sA)("AlertDialogContent"),v=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,children:a,...o}=e,c=x(s),m=t.useRef(null),u=(0,n.e)(r,m),h=t.useRef(null);return(0,d.jsx)(l.jm,{contentName:j,titleName:w,docsSlug:"alert-dialog",children:(0,d.jsx)(b,{scope:s,cancelRef:h,children:(0,d.jsxs)(l.VY,{role:"alertdialog",...c,...o,ref:u,onOpenAutoFocus:(0,i.Mj)(o.onOpenAutoFocus,e=>{var r;e.preventDefault(),null===(r=h.current)||void 0===r||r.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,d.jsx)(y,{children:a}),(0,d.jsx)(z,{contentRef:m})]})})})});v.displayName=j;var w="AlertDialogTitle",C=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,...t}=e,a=x(s);return(0,d.jsx)(l.Dx,{...a,...t,ref:r})});C.displayName=w;var k="AlertDialogDescription",Z=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,...t}=e,a=x(s);return(0,d.jsx)(l.dk,{...a,...t,ref:r})});Z.displayName=k;var A=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,...t}=e,a=x(s);return(0,d.jsx)(l.x8,{...a,...t,ref:r})});A.displayName="AlertDialogAction";var D="AlertDialogCancel",S=t.forwardRef((e,r)=>{let{__scopeAlertDialog:s,...t}=e,{cancelRef:a}=N(D,s),i=x(s),o=(0,n.e)(r,a);return(0,d.jsx)(l.x8,{...i,...t,ref:o})});S.displayName=D;var z=e=>{let{contentRef:r}=e,s="`".concat(j,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(j,"` by passing a `").concat(k,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(j,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return t.useEffect(()=>{var e;document.getElementById(null===(e=r.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(s)},[s,r]),null},P=h,T=f,M=p,E=g,R=v,_=A,O=S,I=C,V=Z}},function(e){e.O(0,[3609,9015,3676,5569,4438,9436,3909,2696,4116,4200,6818,5184,2365,2313,2971,2117,1744],function(){return e(e.s=9943)}),_N_E=e.O()}]);