(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{61832:function(e,s,r){Promise.resolve().then(r.bind(r,2580))},2580:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return X}});var a=r(57437),t=r(2265),l=r(99376),n=r(5978),i=r(1850),c=r(46410),d=r(44794);let o=(0,r(79205).Z)("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);var m=r(61649),x=r(99397),h=r(73247),u=r(67782),p=r(42208),j=r(15868),g=r(62720),f=r(14438),N=r(33804),v=r(12381),b=r(32060),w=r(69174),y=r(68245),C=r(40279),k=r(79820),S=r(97349),z=r(25751),Z=r(29501),E=r(13590),I=r(67119),M=r(74291),A=r(80670),F=r(15291),D=r(23675);let O=I.Ry({newFragranceId:I.Z_({required_error:"必須選擇一個新的香精"}),reason:I.Z_().min(5,{message:"更換原因至少需要 5 個字元"})});function q(e){let{isOpen:s,onOpenChange:r,onUpdate:l,productData:d,currentFragranceName:o}=e,[m,x]=(0,t.useState)(!1),[u,p]=(0,t.useState)([]),[j,g]=(0,t.useState)([]),[N,b]=(0,t.useState)(""),[w,y]=(0,t.useState)(!1),k=(0,Z.cI)({resolver:(0,E.F)(O),defaultValues:{newFragranceId:void 0,reason:""}});async function S(e){if(!d)return;x(!0);let s=f.Am.loading("正在更換香精...");try{let a=(0,i.$C)(),t=(0,i.V1)(a,"changeProductFragrance");await t({productId:d.id,newFragranceId:e.newFragranceId,reason:e.reason}),f.Am.success("產品 ".concat(d.name," 的香精已成功更換。"),{id:s}),l(),r(!1)}catch(r){let e=r instanceof Error?r.message:"發生未知錯誤。";f.Am.error(e,{id:s})}finally{x(!1)}}return(0,t.useEffect)(()=>{s&&((async()=>{try{if(!c.db)throw Error("Firebase 未初始化");let e=(0,n.query)((0,n.collection)(c.db,"fragrances"),(0,n.where)("status","==","active")),s=(await (0,n.getDocs)(e)).docs.map(e=>({value:e.id,label:"".concat(e.data().code,"(").concat(e.data().name,")")})).filter(e=>{var s;return e.value!==(null==d?void 0:null===(s=d.currentFragranceRef)||void 0===s?void 0:s.id)});g(s),p(s)}catch(e){f.Am.error("讀取香精選項失敗。")}})(),k.reset({newFragranceId:void 0,reason:""}),b(""))},[s,d,k]),(0,t.useEffect)(()=>{""===N.trim()?p(j):p(j.filter(e=>e.label.toLowerCase().includes(N.toLowerCase())))},[N,j]),(0,a.jsx)(M.Vq,{open:s,onOpenChange:r,children:(0,a.jsxs)(M.cZ,{className:"sm:max-w-md bg-white dark:bg-slate-900","aria-describedby":"fragrance-change-dialog-description",children:[(0,a.jsxs)(M.fK,{children:[(0,a.jsx)(M.$N,{children:"更換產品香精"}),(0,a.jsxs)(M.Be,{id:"fragrance-change-dialog-description",children:["為產品「",null==d?void 0:d.name,"」更換新的香精。此操作將會被記錄。"]})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"目前香精"}),(0,a.jsx)("p",{className:"font-semibold",children:o})]}),(0,a.jsx)(A.l0,{...k,children:(0,a.jsxs)("form",{onSubmit:k.handleSubmit(S),className:"space-y-4",children:[(0,a.jsx)(A.Wi,{control:k.control,name:"newFragranceId",render:e=>{let{field:s}=e;return(0,a.jsxs)(A.xJ,{children:[(0,a.jsx)(A.lX,{children:"選擇新香精"}),(0,a.jsxs)(F.Ph,{onValueChange:e=>{s.onChange(e),y(!1)},defaultValue:s.value,open:w,onOpenChange:y,children:[(0,a.jsx)(A.NI,{children:(0,a.jsx)(F.i4,{children:(0,a.jsx)(F.ki,{placeholder:"從可用的香精中選擇..."})})}),(0,a.jsxs)(F.Bw,{children:[(0,a.jsxs)("div",{className:"flex items-center px-3 py-2 border-b",children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(C.I,{placeholder:"搜尋香精...",value:N,onChange:e=>b(e.target.value),className:"border-0 focus-visible:ring-0 focus-visible:ring-offset-0"})]}),u.map(e=>(0,a.jsx)(F.Ql,{value:e.value,children:e.label},e.value))]})]}),(0,a.jsx)(A.zG,{})]})}}),(0,a.jsx)(A.Wi,{control:k.control,name:"reason",render:e=>{let{field:s}=e;return(0,a.jsxs)(A.xJ,{children:[(0,a.jsx)(A.lX,{children:"更換原因"}),(0,a.jsx)(A.NI,{children:(0,a.jsx)(D.g,{placeholder:"請詳細說明更換原因，例如：配方升級、舊版停產等...",className:"resize-none",...s})}),(0,a.jsx)(A.zG,{})]})}}),(0,a.jsx)(v.z,{type:"submit",disabled:m,className:"w-full mt-4",children:m?"處理中...":"確認更換"})]})})]})})}var V=r(64853);function P(){let e=(0,l.useRouter)(),s=(0,l.useSearchParams)(),[r,Z]=(0,t.useState)([]),[E,I]=(0,t.useState)(!0),[M,A]=(0,t.useState)(!1),[F,D]=(0,t.useState)(!1),[O,P]=(0,t.useState)(!1),[X,_]=(0,t.useState)(!1),[L,R]=(0,t.useState)(null),[$,G]=(0,t.useState)(!1),[W,J]=(0,t.useState)(null),[Q,B]=(0,t.useState)(new Set),[U,K]=(0,t.useState)(!1),[Y,H]=(0,t.useState)(""),[T,ee]=(0,t.useState)([]),[es,er]=(0,t.useState)(new Set),[ea,et]=(0,t.useState)(new Set),el=(0,t.useCallback)(async()=>{I(!0);try{if(!c.db)throw Error("Firebase 未初始化");let e=new Map,s=new Map;(await (0,n.getDocs)((0,n.collection)(c.db,"productSeries"))).forEach(s=>e.set(s.id,s.data().name)),(await (0,n.getDocs)((0,n.collection)(c.db,"fragrances"))).forEach(e=>{let r=e.data();s.set(e.id,{name:r.name||"未知香精",code:r.code||""})});let r=(await (0,n.getDocs)((0,n.collection)(c.db,"products"))).docs.map(r=>{var a,t;let l=r.data(),n=s.get(null===(a=l.currentFragranceRef)||void 0===a?void 0:a.id);return{...l,id:r.id,seriesName:e.get(null===(t=l.seriesRef)||void 0===t?void 0:t.id)||"未知系列",fragranceName:(null==n?void 0:n.name)||"未知香精",fragranceCode:(null==n?void 0:n.code)||""}}).sort((e,s)=>{let r=(e.seriesName||"").localeCompare(s.seriesName||"");return 0!==r?r:(e.name||"").localeCompare(s.name||"")});Z(r),ee(r)}catch(e){console.error("讀取產品資料失敗:",e),f.Am.error("讀取產品資料失敗。")}finally{I(!1)}},[]);(0,t.useEffect)(()=>{el()},[el]),(0,t.useEffect)(()=>{if(!Y.trim()&&0===es.size&&0===ea.size){ee(r);return}ee(r.filter(e=>{if(Y.trim()){var s,r,a,t,l;let n=Y.toLowerCase();if(!((null===(s=e.code)||void 0===s?void 0:s.toLowerCase().includes(n))||(null===(r=e.name)||void 0===r?void 0:r.toLowerCase().includes(n))||(null===(a=e.seriesName)||void 0===a?void 0:a.toLowerCase().includes(n))||(null===(t=e.fragranceName)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(l=e.fragranceCode)||void 0===l?void 0:l.toLowerCase().includes(n))))return!1}return es.size,!(ea.size>0)||!!ea.has(e.seriesName||"")}).sort((e,s)=>{let r=(e.seriesName||"").localeCompare(s.seriesName||"");return 0!==r?r:(e.name||"").localeCompare(s.name||"")}))},[r,Y,es,ea]),(0,t.useEffect)(()=>{let a=s.get("edit");if(a&&r.length>0){let s=r.find(e=>e.id===a);s&&(J(s),A(!0),e.replace("/dashboard/products"))}},[s,r,e]);let en=()=>{J(null),A(!0)},ei=e=>{J(e),A(!0)},ec=e=>{J(e),D(!0)},ed=s=>{e.push("/dashboard/products/".concat(s.id))},eo=()=>{e.push("/dashboard/product-series")},em=(e,s)=>{let r=new Set(Q);s?r.add(e):r.delete(e),B(r)},ex=async()=>{if(!W)return;let e=f.Am.loading("正在刪除產品...");try{let s=(0,i.$C)(),r=(0,i.V1)(s,"deleteProduct");await r({productId:W.id}),f.Am.success("產品 ".concat(W.name," 已成功刪除。"),{id:e}),el()}catch(r){console.error("刪除產品失敗:",r);let s="刪除產品時發生錯誤。";r instanceof Error&&(s=r.message),f.Am.error(s,{id:e})}finally{D(!1),J(null)}},eh=async()=>{if(0===Q.size)return;let e=f.Am.loading("正在刪除 ".concat(Q.size," 個產品..."));try{let s=(0,i.$C)(),r=(0,i.V1)(s,"deleteProduct"),a=Array.from(Q).map(e=>r({productId:e}));await Promise.all(a),f.Am.success("已成功刪除 ".concat(Q.size," 個產品。"),{id:e}),B(new Set),el()}catch(r){console.error("批次刪除產品失敗:",r);let s="批次刪除產品時發生錯誤。";r instanceof Error&&(s=r.message),f.Am.error(s,{id:e})}finally{K(!1)}},eu=async(e,s,r)=>{if(!c.db)throw Error("Firebase 未初始化");let a=(0,i.$C)(),t=(0,i.V1)(a,"createProduct"),l=(0,i.V1)(a,"updateProduct"),d=0,o=e.length,m={success:0,failed:0,failedItems:[]};for(let a of e)try{let e=null;if(a.seriesName){let s=(0,n.query)((0,n.collection)(c.db,"productSeries"),(0,n.where)("name","==",a.seriesName)),r=await (0,n.getDocs)(s);if(r.empty)throw Error('系列名稱 "'.concat(a.seriesName,'" 不存在於系統中'));e=r.docs[0].id}let i=null;if(a.fragranceCode){let e=(0,n.query)((0,n.collection)(c.db,"fragrances"),(0,n.where)("code","==",a.fragranceCode)),s=await (0,n.getDocs)(e);if(s.empty)throw Error('香精編號 "'.concat(a.fragranceCode,'" 不存在於系統中'));i=s.docs[0].id}let x=null;if(a.code&&""!==a.code.trim()){let e=(0,n.query)((0,n.collection)(c.db,"products"),(0,n.where)("code","==",a.code)),s=await (0,n.getDocs)(e);s.empty||(x=s.docs[0].id)}let h={name:a.name,seriesId:e,fragranceId:i,nicotineMg:a.nicotineMg||0,specificMaterialIds:a.specificMaterialIds||[],status:a.status||"啟用"};a.code&&""!==a.code.trim()&&(h.code=a.code),x&&(null==s?void 0:s.updateMode)?await l({productId:x,...h}):x?console.warn('產品代號 "'.concat(a.code,'" 已存在，跳過創建')):await t(h),m.success++,d++,r&&r(d,o)}catch(t){console.error("匯入產品失敗:",t);let e=t instanceof Error?t.message:"未知錯誤";if(m.failed++,m.failedItems.push({item:a,error:e,row:d+1}),!(null==s?void 0:s.updateMode))throw Error('匯入產品 "'.concat(a.name,'" 失敗: ').concat(e));d++,r&&r(d,o)}if(m.failed>0){let e=Error("匯入完成，成功 ".concat(m.success," 筆，失敗 ").concat(m.failed," 筆"));throw e.results=m,e}el()},ep=async()=>r.map(e=>({name:e.name,code:e.code,seriesName:e.seriesName,fragranceCode:e.fragranceCode,nicotineMg:e.nicotineMg,status:e.status||"啟用"}));return(0,a.jsxs)("div",{className:"container mx-auto py-10",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"產品管理"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"管理產品資訊與系列配置"})]})}),(0,a.jsxs)("div",{className:"lg:hidden mb-6",children:[Q.size>0&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)(v.z,{variant:"destructive",onClick:()=>K(!0),className:"w-full bg-red-600 hover:bg-red-700 text-white",children:[(0,a.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"批次刪除 (",Q.size," 個產品)"]})}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)(v.z,{variant:"outline",onClick:eo,className:"border-purple-200 text-purple-600 hover:bg-purple-100 hover:border-purple-300 hover:shadow-sm transition-all duration-200",children:[(0,a.jsx)(o,{className:"mr-2 h-4 w-4"}),"系列管理"]}),(0,a.jsxs)(v.z,{variant:"outline",onClick:()=>_(!0),className:"w-full",children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"匯入/匯出"]}),(0,a.jsxs)(v.z,{onClick:en,className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"新增產品"]})]})]}),(0,a.jsx)("div",{className:"hidden lg:block mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[Q.size>0&&(0,a.jsxs)(v.z,{variant:"destructive",onClick:()=>K(!0),className:"bg-red-600 hover:bg-red-700 text-white",children:[(0,a.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"批次刪除 (",Q.size,")"]}),(0,a.jsxs)(v.z,{variant:"outline",onClick:eo,className:"border-purple-200 text-purple-600 hover:bg-purple-600 hover:text-white hover:border-purple-600 transition-all duration-200",children:[(0,a.jsx)(o,{className:"mr-2 h-4 w-4"}),"系列管理"]}),(0,a.jsxs)(v.z,{variant:"outline",onClick:()=>_(!0),children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"匯入/匯出"]}),(0,a.jsxs)(v.z,{onClick:en,className:"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"新增產品"]})]})}),(0,a.jsx)(k.Zb,{className:"mb-6 border-0 shadow-lg bg-gradient-to-r from-gray-50 to-purple-50",children:(0,a.jsx)(k.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Z,{className:"absolute left-3 top-3 h-4 w-4 text-purple-600"}),(0,a.jsx)(C.I,{placeholder:"搜尋產品名稱、代號、系列或香精...",value:Y,onChange:e=>H(e.target.value),className:"pl-10 border-purple-200 focus:border-purple-500 focus:ring-purple-500"})]})})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(new Set(r.map(e=>e.seriesName))).map(e=>(0,a.jsx)(w.C,{variant:ea.has(e||"")?"default":"secondary",className:"cursor-pointer transition-colors ".concat(ea.has(e||"")?"bg-purple-600 hover:bg-purple-700 text-white":"bg-purple-100 hover:bg-purple-200 text-purple-800 border-purple-300"),onClick:()=>{et(s=>{let r=new Set(s);return r.has(e||"")?r.delete(e||""):r.add(e||""),r})},children:e},e))})}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden mb-6",children:[(0,a.jsx)("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-purple-50 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 text-purple-600"}),(0,a.jsx)("h2",{className:"text-base font-semibold text-gray-800",children:"產品清單"})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["共 ",T.length," 個"]})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"min-w-full",children:E?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-purple-200 rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 w-10 h-10 border-4 border-transparent border-t-purple-600 rounded-full animate-spin"})]}),(0,a.jsx)("span",{className:"mt-3 text-sm text-gray-600 font-medium",children:"載入中..."})]}):T.length>0?(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:T.map(e=>(0,a.jsxs)("div",{className:"p-4 hover:bg-purple-100/60 transition-all duration-200 border border-transparent hover:border-purple-200 hover:shadow-sm rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer flex-1",onClick:()=>ed(e),children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"h-4 w-4 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 text-sm",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-green-600 font-medium",children:e.code})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.X,{checked:Q.has(e.id),onCheckedChange:s=>em(e.id,s)}),(0,a.jsxs)(b.h_,{children:[(0,a.jsx)(b.$F,{asChild:!0,children:(0,a.jsx)(v.z,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(b.AW,{align:"end",children:[(0,a.jsxs)(b.Xi,{onClick:()=>ed(e),children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"查看詳細"]}),(0,a.jsxs)(b.Xi,{onClick:()=>ei(e),children:[(0,a.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"編輯產品"]}),(0,a.jsx)(b.VD,{}),(0,a.jsxs)(b.Xi,{onClick:()=>ec(e),className:"text-red-600",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"刪除產品"]})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-sm cursor-pointer",onClick:()=>ed(e),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center gap-1 mb-1",children:(0,a.jsx)("span",{className:"text-gray-500",children:"系列"})}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.seriesName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center gap-1 mb-1",children:(0,a.jsx)("span",{className:"text-gray-500",children:"使用香精"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-green-600",children:e.fragranceCode||"未指定"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.fragranceName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center gap-1 mb-1",children:(0,a.jsx)("span",{className:"text-gray-500",children:"丁鹽濃度"})}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[e.nicotineMg||0," MG"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)(g.Z,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"狀態"})]}),(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("備用"===e.status?"bg-yellow-100 text-yellow-800":"棄用"===e.status?"bg-pink-100 text-pink-800":"bg-green-100 text-green-800"),children:e.status||"啟用"})]})]})]},e.id))}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-muted rounded-full flex items-center justify-center mb-3",children:(0,a.jsx)(d.Z,{className:"h-6 w-6 text-muted-foreground"})}),(0,a.jsx)("h3",{className:"text-base font-medium text-foreground mb-1",children:"沒有產品資料"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4 text-center",children:"開始建立第一個產品來管理產品資訊"}),(0,a.jsxs)(v.z,{onClick:en,variant:"outline",size:"sm",className:"border-purple-200 text-purple-600 hover:bg-purple-50",children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"新增產品"]})]})})})]})}),(0,a.jsx)("div",{className:"hidden lg:block",children:(0,a.jsxs)("div",{className:"bg-card rounded-xl shadow-lg border border-border overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-background to-purple-50 border-b border-border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 text-purple-600"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"產品清單"})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["共 ",T.length," 個產品"]})]})}),(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)(N.iA,{className:"table-enhanced",children:[(0,a.jsx)(N.xD,{children:(0,a.jsxs)(N.SC,{children:[(0,a.jsx)(N.ss,{className:"w-[60px] text-center",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",title:"全選所有產品",children:[(0,a.jsx)(y.X,{checked:Q.size===T.length&&T.length>0,onCheckedChange:e=>{e?B(new Set(T.map(e=>e.id))):B(new Set)}}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"全選"})]})}),(0,a.jsx)(N.ss,{className:"text-left",children:"產品資訊"}),(0,a.jsx)(N.ss,{className:"text-left",children:"系列"}),(0,a.jsx)(N.ss,{className:"text-left",children:"使用香精"}),(0,a.jsx)(N.ss,{className:"text-left",children:"丁鹽濃度"}),(0,a.jsx)(N.ss,{className:"text-left",children:"狀態"}),(0,a.jsx)(N.ss,{className:"text-right",children:"操作"})]})}),(0,a.jsx)(N.RM,{children:E?(0,a.jsx)(N.SC,{children:(0,a.jsx)(N.pj,{colSpan:7,className:"text-center py-16",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-purple-200 rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 w-12 h-12 border-4 border-transparent border-t-purple-600 rounded-full animate-spin"})]}),(0,a.jsx)("span",{className:"mt-4 text-muted-foreground font-medium",children:"載入產品資料中..."})]})})}):T.length>0?T.map(e=>(0,a.jsxs)(N.SC,{className:"hover:bg-purple-200/70 hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>ed(e),children:[(0,a.jsx)(N.pj,{className:"text-center",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(y.X,{checked:Q.has(e.id),onCheckedChange:s=>em(e.id,s)})}),(0,a.jsx)(N.pj,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-foreground",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-green-600 font-medium",children:e.code})]})]})}),(0,a.jsx)(N.pj,{children:(0,a.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.seriesName})}),(0,a.jsx)(N.pj,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium text-green-600",children:e.fragranceCode||"未指定"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.fragranceName})]})}),(0,a.jsx)(N.pj,{children:(0,a.jsxs)("span",{className:"text-sm font-medium text-foreground",children:[e.nicotineMg||0," MG"]})}),(0,a.jsx)(N.pj,{children:(0,a.jsx)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("備用"===e.status?"bg-yellow-100 text-yellow-800":"棄用"===e.status?"bg-pink-100 text-pink-800":"bg-green-100 text-green-800"),children:e.status||"啟用"})}),(0,a.jsx)(N.pj,{className:"text-right",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)(b.h_,{children:[(0,a.jsx)(b.$F,{asChild:!0,children:(0,a.jsxs)(v.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"開啟選單"}),(0,a.jsx)(u.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)(b.AW,{align:"end",children:[(0,a.jsx)(b.Ju,{children:"操作"}),(0,a.jsx)(b.VD,{}),(0,a.jsxs)(b.Xi,{onClick:()=>ed(e),children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"查看詳細"]}),(0,a.jsxs)(b.Xi,{onClick:()=>ei(e),children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"編輯產品"]}),(0,a.jsx)(b.VD,{}),(0,a.jsx)(b.Xi,{onClick:()=>ec(e),className:"text-red-600 focus:text-red-600",children:"刪除產品"})]})]})})]},e.id)):(0,a.jsx)(N.SC,{children:(0,a.jsx)(N.pj,{colSpan:7,className:"text-center py-16",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(d.Z,{className:"h-8 w-8 text-muted-foreground"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"沒有產品資料"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"開始建立第一個產品來管理產品資訊"}),(0,a.jsxs)(v.z,{onClick:en,variant:"outline",className:"border-purple-200 text-purple-600 hover:bg-purple-50",children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"新增產品"]})]})})})})]})})]})}),(0,a.jsx)(S.u,{isOpen:M,onOpenChange:A,onProductUpdate:el,productData:W}),W&&(0,a.jsx)(z.Q,{isOpen:F,onOpenChange:D,onConfirm:ex,title:"確認刪除產品",description:"您確定要永久刪除產品「".concat(W.name,"」嗎？此操作無法復原。")}),(0,a.jsx)(z.Q,{isOpen:U,onOpenChange:K,onConfirm:eh,title:"確認批次刪除",description:"您確定要永久刪除選中的 ".concat(Q.size," 個產品嗎？此操作無法復原。")}),(0,a.jsx)(q,{isOpen:O,onOpenChange:P,onUpdate:el,productData:W,currentFragranceName:(null==W?void 0:W.fragranceName)||""}),(0,a.jsx)(V.Z,{isOpen:X,onOpenChange:_,onImport:eu,onExport:ep,title:"產品資料",description:"匯入或匯出產品資料，支援 Excel 和 CSV 格式",sampleData:[{name:"示例產品",code:"",seriesName:"示例系列",fragranceCode:"FRAG001",nicotineMg:3,status:"啟用"}],fields:[{key:"name",label:"產品名稱",required:!0,type:"string"},{key:"code",label:"產品代號",required:!1,type:"string"},{key:"seriesName",label:"系列名稱",required:!0,type:"string"},{key:"fragranceCode",label:"香精編號",required:!0,type:"string"},{key:"nicotineMg",label:"尼古丁濃度",required:!1,type:"number"},{key:"status",label:"狀態",required:!1,type:"string"}]})]})}function X(){return(0,a.jsx)(t.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(P,{})})}}},function(e){e.O(0,[3609,9015,1425,3676,5569,4438,9436,3909,2696,4116,4200,6818,5184,5711,2365,2313,7613,7349,2971,2117,1744],function(){return e(e.s=61832)}),_N_E=e.O()}]);