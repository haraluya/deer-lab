(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4854],{6607:function(e,t,r){Promise.resolve().then(r.bind(r,57442))},67782:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},44794:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},99397:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},15868:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},62720:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},57442:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var a=r(57437),n=r(2265),s=r(5978),l=r(46410),o=r(14438),i=r(99397),c=r(62720),d=r(44794),u=r(12381),m=r(69174),g=r(67119),f=r(85452);function x(){let[e,t]=(0,n.useState)([]),[r,g]=(0,n.useState)(!0),[x,h]=(0,n.useState)(!1),y=async()=>{g(!0);try{if(!l.db)throw Error("Firebase 未初始化");let r=await (0,s.getDocs)((0,s.collection)(l.db,"materials")),a=new Map,n=new Map;r.docs.forEach(e=>{let t=e.data();if(t.category){let e=a.get(t.category)||{count:0,id:t.mainCategoryId};e.count+=1,t.mainCategoryId&&(e.id=t.mainCategoryId),a.set(t.category,e)}if(t.subCategory){let e=n.get(t.subCategory)||{count:0,id:t.subCategoryId};e.count+=1,t.subCategoryId&&(e.id=t.subCategoryId),n.set(t.subCategory,e)}});try{(await (0,s.getDocs)((0,s.collection)(l.db,"materialCategories"))).docs.forEach(t=>{var r;let n=t.data(),s=(null===(r=a.get(n.name))||void 0===r?void 0:r.count)||0;e.push({id:t.id,name:n.name,type:"category",usageCount:s,generatedId:n.id||function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t="";for(let r=0;r<2;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}()})})}catch(e){console.log("主分類集合不存在，跳過")}try{(await (0,s.getDocs)((0,s.collection)(l.db,"materialSubCategories"))).docs.forEach(t=>{var r;let a=t.data(),s=(null===(r=n.get(a.name))||void 0===r?void 0:r.count)||0;e.push({id:t.id,name:a.name,type:"subCategory",usageCount:s,generatedId:a.id||function(){let e="";for(let t=0;t<3;t++)e+=Math.floor(10*Math.random());return e}()})})}catch(e){console.log("細分分類集合不存在，跳過")}let o=e.filter(e=>"category"===e.type).sort((e,t)=>e.name.localeCompare(t.name)),i=e.filter(e=>"subCategory"===e.type).sort((e,t)=>e.name.localeCompare(t.name));t([...o,...i])}catch(e){console.error("載入分類失敗:",e),o.Am.error("載入分類失敗")}finally{g(!1)}};return(0,n.useEffect)(()=>{y()},[]),(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"物料分類管理"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"管理物料分類與細分分類"})]}),(0,a.jsxs)(u.z,{onClick:()=>h(!0),className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,a.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"管理分類"]})]}),r&&(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,t)=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 animate-pulse",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]},t))}),!r&&(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.length>0?e.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 hover:shadow-xl transition-all duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("category"===e.type?"bg-gradient-to-br from-blue-500 to-indigo-600":"bg-gradient-to-br from-green-500 to-emerald-600"),children:"category"===e.type?(0,a.jsx)(c.Z,{className:"h-5 w-5 text-white"}):(0,a.jsx)(d.Z,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"category"===e.type?"主分類":"細分分類"})]})]}),(0,a.jsx)(m.C,{className:"".concat("category"===e.type?"bg-blue-100 text-blue-800 border-blue-200":"bg-green-100 text-green-800 border-green-200"),children:e.generatedId||"待生成"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"使用數量"}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[e.usageCount," 個物料"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"分類類型"}),(0,a.jsx)("span",{className:"font-medium ".concat("category"===e.type?"text-blue-600":"text-green-600"),children:"category"===e.type?"主分類":"細分分類"})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"點擊查看詳情"})})]},e.id)):(0,a.jsxs)("div",{className:"col-span-full flex flex-col items-center justify-center py-16",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(c.Z,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"沒有分類資料"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"開始建立第一個分類來管理物料"}),(0,a.jsxs)(u.z,{onClick:()=>h(!0),variant:"outline",className:"border-teal-200 text-teal-600 hover:bg-teal-50",children:[(0,a.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"新增分類"]})]})}),(0,a.jsx)(f.J,{isOpen:x,onOpenChange:h})]})}function h(){return(0,a.jsx)(x,{})}g.Ry({name:g.Z_().min(1,"分類名稱不能為空"),type:g.Km(["category","subCategory"])})},79820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return i},Zb:function(){return s},aY:function(){return c},eW:function(){return d},ll:function(){return o}});var a=r(57437);r(2265);var n=r(93448);function s(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-lg border-2 p-6 shadow-md",t),...r})}function l(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 has-data-[slot=card-action]:grid-cols-[1fr_auto]",t),...r})}function o(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...r})}function i(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center",t),...r})}},90277:function(e,t,r){"use strict";r.d(t,{$j:function(){return P},Dx:function(){return V},VY:function(){return S},aU:function(){return z},aV:function(){return _},dk:function(){return F},fC:function(){return E},h_:function(){return R},xz:function(){return O}});var a=r(2265),n=r(73966),s=r(98575),l=r(49027),o=r(6741),i=r(37053),c=r(57437),d="AlertDialog",[u,m]=(0,n.b)(d,[l.p8]),g=(0,l.p8)(),f=e=>{let{__scopeAlertDialog:t,...r}=e,a=g(t);return(0,c.jsx)(l.fC,{...a,...r,modal:!0})};f.displayName=d;var x=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=g(r);return(0,c.jsx)(l.xz,{...n,...a,ref:t})});x.displayName="AlertDialogTrigger";var h=e=>{let{__scopeAlertDialog:t,...r}=e,a=g(t);return(0,c.jsx)(l.h_,{...a,...r})};h.displayName="AlertDialogPortal";var y=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=g(r);return(0,c.jsx)(l.aV,{...n,...a,ref:t})});y.displayName="AlertDialogOverlay";var p="AlertDialogContent",[b,v]=u(p),j=(0,i.sA)("AlertDialogContent"),N=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:n,...i}=e,d=g(r),u=a.useRef(null),m=(0,s.e)(t,u),f=a.useRef(null);return(0,c.jsx)(l.jm,{contentName:p,titleName:w,docsSlug:"alert-dialog",children:(0,c.jsx)(b,{scope:r,cancelRef:f,children:(0,c.jsxs)(l.VY,{role:"alertdialog",...d,...i,ref:m,onOpenAutoFocus:(0,o.Mj)(i.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=f.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,c.jsx)(j,{children:n}),(0,c.jsx)(I,{contentRef:u})]})})})});N.displayName=p;var w="AlertDialogTitle",C=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=g(r);return(0,c.jsx)(l.Dx,{...n,...a,ref:t})});C.displayName=w;var k="AlertDialogDescription",A=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=g(r);return(0,c.jsx)(l.dk,{...n,...a,ref:t})});A.displayName=k;var D=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,n=g(r);return(0,c.jsx)(l.x8,{...n,...a,ref:t})});D.displayName="AlertDialogAction";var Z="AlertDialogCancel",M=a.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,{cancelRef:n}=v(Z,r),o=g(r),i=(0,s.e)(t,n);return(0,c.jsx)(l.x8,{...o,...a,ref:i})});M.displayName=Z;var I=e=>{let{contentRef:t}=e,r="`".concat(p,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(p,"` by passing a `").concat(k,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(p,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return a.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},E=f,O=x,R=h,_=y,S=N,z=D,P=M,V=C,F=A}},function(e){e.O(0,[3609,9015,3676,5569,4438,9436,3909,2696,4116,6818,5184,2365,2313,5452,2971,2117,1744],function(){return e(e.s=6607)}),_N_E=e.O()}]);