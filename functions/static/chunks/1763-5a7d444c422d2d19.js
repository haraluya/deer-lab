"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1763],{60044:function(e,t,s){s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},44794:function(e,t,s){s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},13041:function(e,t,s){s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},15868:function(e,t,s){s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},92369:function(e,t,s){s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},62116:function(e,t,s){s.d(t,{g:function(){return w}});var r=s(57437),a=s(2265),l=s(29501),n=s(13590),o=s(67119),d=s(1850),i=s(5978),c=s(46410),h=s(14438),p=s(60044),u=s(92369),m=s(44794),x=s(12381),f=s(74291),g=s(80670),j=s(40279),y=s(15291),b=s(23675);let N=o.Ry({name:o.Z_().min(2,{message:"供應商名稱至少需要 2 個字元"}),products:o.Z_().optional(),contactWindow:o.Z_().optional(),contactMethod:o.Z_().optional(),liaisonPersonId:o.Z_().optional(),notes:o.Z_().optional()});function w(e){let{isOpen:t,onOpenChange:s,onSupplierUpdate:o,supplierData:w}=e,[k,v]=(0,a.useState)(!1),[Z,I]=(0,a.useState)([]),M=!!w,z=(0,l.cI)({resolver:(0,n.F)(N),defaultValues:{name:"",products:"",contactWindow:"",contactMethod:"",liaisonPersonId:"",notes:""}});async function _(e){v(!0);let t=h.Am.loading(M?"正在更新供應商...":"正在新增供應商...");try{let r=(0,d.$C)();if(console.log("提交的資料:",e),M){let s=(0,d.V1)(r,"updateSupplier"),a=await s({supplierId:w.id,...e});console.log("更新結果:",a),h.Am.success("供應商 ".concat(e.name," 的資料已成功更新。"),{id:t})}else{let s=(0,d.V1)(r,"createSupplier"),a=await s(e);console.log("建立結果:",a),h.Am.success("供應商 ".concat(e.name," 已成功建立。"),{id:t})}o(),s(!1)}catch(s){console.error("Error submitting supplier form:",s);let e=M?"更新供應商資料時發生錯誤。":"新增供應商時發生錯誤。";s instanceof Error&&(e=s.message),h.Am.error(e,{id:t})}finally{v(!1)}}return(0,a.useEffect)(()=>{let e=async()=>{try{if(!c.db){console.error("Firestore 未初始化");return}let e=(await (0,i.getDocs)((0,i.collection)(c.db,"users"))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>"active"===e.status).map(e=>({id:e.id,name:e.name,employeeId:e.employeeId,phone:e.phone,status:e.status}));I(e)}catch(e){console.error("載入人員資料失敗:",e),h.Am.error("載入人員資料失敗")}};t&&e()},[t]),(0,a.useEffect)(()=>{t&&(w?z.reset({name:w.name||"",products:w.products||"",contactWindow:w.contactWindow||"",contactMethod:w.contactMethod||"",liaisonPersonId:w.liaisonPersonId||"",notes:w.notes||""}):z.reset({name:"",products:"",contactWindow:"",contactMethod:"",liaisonPersonId:"",notes:""}))},[t,w,z]),(0,r.jsx)(f.Vq,{open:t,onOpenChange:s,children:(0,r.jsxs)(f.cZ,{className:"max-w-3xl max-h-[90vh] overflow-y-auto","aria-describedby":"supplier-dialog-description",children:[(0,r.jsxs)(f.fK,{className:"relative",children:[(0,r.jsxs)(f.$N,{className:"flex items-center gap-2 pr-20",children:[(0,r.jsx)(p.Z,{className:"h-5 w-5"}),M?"編輯供應商資料":"新增供應商"]}),(0,r.jsx)(f.Be,{id:"supplier-dialog-description",className:"pr-20",children:M?"修改供應商的詳細聯絡資訊。":"請填寫新供應商的詳細聯絡資訊。"}),(0,r.jsxs)("div",{className:"absolute top-0 right-0 flex gap-2",children:[(0,r.jsx)(x.z,{type:"button",variant:"outline",size:"sm",onClick:()=>s(!1),children:"關閉"}),(0,r.jsx)(x.z,{form:"supplier-form",type:"submit",size:"sm",disabled:k,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white",children:k?"處理中...":M?"更新":"新增"})]})]}),(0,r.jsx)(g.l0,{...z,children:(0,r.jsxs)("form",{id:"supplier-form",onSubmit:z.handleSubmit(_),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 text-blue-800",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4"}),"基本資料"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(g.Wi,{control:z.control,name:"name",render:e=>{let{field:t}=e;return(0,r.jsxs)(g.xJ,{children:[(0,r.jsx)(g.lX,{children:"供應商名稱 *"}),(0,r.jsx)(g.NI,{children:(0,r.jsx)(j.I,{placeholder:"例如：ABC 原料公司",...t})}),(0,r.jsx)(g.zG,{})]})}}),(0,r.jsx)(g.Wi,{control:z.control,name:"products",render:e=>{let{field:t}=e;return(0,r.jsxs)(g.xJ,{children:[(0,r.jsx)(g.lX,{children:"供應商品"}),(0,r.jsx)(g.NI,{children:(0,r.jsx)(j.I,{placeholder:"例如：香精、原料、包材",...t})}),(0,r.jsx)(g.zG,{})]})}})]})]}),(0,r.jsxs)("div",{className:"space-y-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 text-green-800",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4"}),"聯絡資訊"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(g.Wi,{control:z.control,name:"contactWindow",render:e=>{let{field:t}=e;return(0,r.jsxs)(g.xJ,{children:[(0,r.jsx)(g.lX,{children:"聯絡窗口"}),(0,r.jsx)(g.NI,{children:(0,r.jsx)(j.I,{placeholder:"例如：王經理",...t})}),(0,r.jsx)(g.zG,{})]})}}),(0,r.jsx)(g.Wi,{control:z.control,name:"contactMethod",render:e=>{let{field:t}=e;return(0,r.jsxs)(g.xJ,{children:[(0,r.jsx)(g.lX,{children:"聯絡方式"}),(0,r.jsx)(g.NI,{children:(0,r.jsx)(j.I,{placeholder:"例如：02-12345678 或 Line ID",...t,className:"border-green-300 focus:border-green-500 focus:ring-green-500"})}),(0,r.jsx)(g.zG,{})]})}}),(0,r.jsx)(g.Wi,{control:z.control,name:"liaisonPersonId",render:e=>{let{field:t}=e;return(0,r.jsxs)(g.xJ,{children:[(0,r.jsx)(g.lX,{children:"對接人員"}),(0,r.jsxs)(y.Ph,{onValueChange:t.onChange,value:t.value,children:[(0,r.jsx)(g.NI,{children:(0,r.jsx)(y.i4,{children:(0,r.jsx)(y.ki,{placeholder:"選擇對接人員"})})}),(0,r.jsx)(y.Bw,{children:Z.map(e=>(0,r.jsx)(y.Ql,{value:e.id,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.employeeId,")"]})]})},e.id))})]}),(0,r.jsx)(g.zG,{})]})}})]})]}),(0,r.jsxs)("div",{className:"space-y-4 p-4 bg-gradient-to-r from-purple-50 to-violet-50 rounded-lg border border-purple-200",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 text-purple-800",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),"備註資訊"]}),(0,r.jsx)(g.Wi,{control:z.control,name:"notes",render:e=>{let{field:t}=e;return(0,r.jsxs)(g.xJ,{children:[(0,r.jsx)(g.lX,{children:"詳細備註"}),(0,r.jsx)(g.NI,{children:(0,r.jsx)(b.g,{placeholder:"請輸入供應商相關的詳細備註資料...",className:"min-h-[120px] resize-none",...t})}),(0,r.jsx)(g.zG,{})]})}})]})]})})]})})}},15291:function(e,t,s){s.d(t,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return f},i4:function(){return p},ki:function(){return h}});var r=s(57437),a=s(2265),l=s(33911),n=s(40875),o=s(22135),d=s(30401),i=s(93448);let c=l.fC;l.ZA;let h=l.B4,p=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsxs)(l.xz,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus:ring-slate-300",s),...o,children:[a,(0,r.jsx)(l.JO,{asChild:!0,children:(0,r.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=l.xz.displayName;let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.u_,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})});u.displayName=l.u_.displayName;let m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.$G,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})});m.displayName=l.$G.displayName;let x=a.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",...o}=e;return(0,r.jsx)(l.h_,{children:(0,r.jsxs)(l.VY,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-white text-slate-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...o,children:[(0,r.jsx)(u,{}),(0,r.jsx)(l.l_,{className:(0,i.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(m,{})]})})});x.displayName=l.VY.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.__,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=l.__.displayName;let f=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(l.ck,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-slate-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.wU,{children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(l.eT,{children:a})]})});f.displayName=l.ck.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.Z0,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-slate-100 dark:bg-slate-800",s),...a})}).displayName=l.Z0.displayName},23675:function(e,t,s){s.d(t,{g:function(){return n}});var r=s(57437),a=s(2265),l=s(93448);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});n.displayName="Textarea"}}]);