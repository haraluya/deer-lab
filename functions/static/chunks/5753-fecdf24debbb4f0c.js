"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5753],{31047:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},38220:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]])},21047:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},82431:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},70525:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},69174:function(e,t,a){a.d(t,{C:function(){return d}});var r=a(57437);a(2265);var n=a(37053),o=a(90535),s=a(93448);let l=(0,o.j)("inline-flex items-center justify-center rounded-full px-2 py-1 text-xs font-medium focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"bg-blue-100 text-blue-700",secondary:"bg-muted text-muted-foreground",destructive:"bg-red-100 text-red-700",outline:"text-foreground border border-border",success:"bg-green-100 text-green-700",warning:"bg-yellow-100 text-yellow-700",purple:"bg-purple-100 text-purple-700"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:a,asChild:o=!1,...d}=e,i=o?n.g7:"span";return(0,r.jsx)(i,{"data-slot":"badge",className:(0,s.cn)(l({variant:a}),t),...d})}},79820:function(e,t,a){a.d(t,{Ol:function(){return s},SZ:function(){return d},Zb:function(){return o},aY:function(){return i},eW:function(){return c},ll:function(){return l}});var r=a(57437);a(2265);var n=a(93448);function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-lg border-2 p-6 shadow-md",t),...a})}function s(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 has-data-[slot=card-action]:grid-cols-[1fr_auto]",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center",t),...a})}},74291:function(e,t,a){a.d(t,{$N:function(){return p},Be:function(){return h},Vq:function(){return d},cN:function(){return m},cZ:function(){return u},fK:function(){return f}});var r=a(57437),n=a(2265),o=a(49027),s=a(32489),l=a(93448);let d=o.fC;o.xz;let i=o.h_;o.x8;let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});c.displayName=o.aV.displayName;let u=n.forwardRef((e,t)=>{let{className:a,children:n,...d}=e;return(0,r.jsxs)(i,{children:[(0,r.jsx)(c,{}),(0,r.jsxs)(o.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-2xl translate-x-[-50%] translate-y-[-50%] gap-4 border-2 border-border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg max-h-[90vh] overflow-y-auto","p-4 sm:p-6 mx-2 sm:mx-0","max-w-[calc(100vw-1rem)] sm:max-w-lg md:max-w-xl lg:max-w-2xl","max-h-[95vh] sm:max-h-[90vh]",a),...d,children:[n,(0,r.jsxs)(o.x8,{className:"absolute right-3 top-3 sm:right-4 sm:top-4 z-10 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground p-1",children:[(0,r.jsx)(s.Z,{className:"h-5 w-5 sm:h-4 sm:w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"關閉"})]})]})]})});u.displayName=o.VY.displayName;let f=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left pb-4 border-b border-border",t),...a})};f.displayName="DialogHeader";let m=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end gap-2 sm:gap-0 sm:space-x-2 pt-4 border-t border-border","[&>*]:w-full sm:[&>*]:w-auto",t),...a})};m.displayName="DialogFooter";let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.Dx,{ref:t,className:(0,l.cn)("text-xl sm:text-2xl font-bold flex items-center gap-2 sm:gap-3 leading-tight",a),...n})});p.displayName=o.Dx.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...n})});h.displayName=o.dk.displayName},40279:function(e,t,a){a.d(t,{I:function(){return s}});var r=a(57437),n=a(2265),o=a(93448);let s=n.forwardRef((e,t)=>{let{className:a,type:n,...s}=e;return(0,r.jsx)("input",{type:n,className:(0,o.cn)("flex w-full rounded-md border border-slate-200 bg-white px-3 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300","h-11 sm:h-10 py-3 sm:py-2","text-base sm:text-sm","min-h-[44px]",a),ref:t,...s})});s.displayName="Input"},75060:function(e,t,a){a.d(t,{_:function(){return s}});var r=a(57437);a(2265);var n=a(6394),o=a(93448);function s(e){let{className:t,...a}=e;return(0,r.jsx)(n.f,{"data-slot":"label",className:(0,o.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},15291:function(e,t,a){a.d(t,{Bw:function(){return h},Ph:function(){return c},Ql:function(){return x},i4:function(){return f},ki:function(){return u}});var r=a(57437),n=a(2265),o=a(33911),s=a(40875),l=a(22135),d=a(30401),i=a(93448);let c=o.fC;o.ZA;let u=o.B4,f=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,r.jsxs)(o.xz,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus:ring-slate-300",a),...l,children:[n,(0,r.jsx)(o.JO,{asChild:!0,children:(0,r.jsx)(s.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=o.xz.displayName;let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.u_,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})});m.displayName=o.u_.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.$G,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,r.jsx)(s.Z,{className:"h-4 w-4"})})});p.displayName=o.$G.displayName;let h=n.forwardRef((e,t)=>{let{className:a,children:n,position:s="popper",...l}=e;return(0,r.jsx)(o.h_,{children:(0,r.jsxs)(o.VY,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-white text-slate-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...l,children:[(0,r.jsx)(m,{}),(0,r.jsx)(o.l_,{className:(0,i.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,r.jsx)(p,{})]})})});h.displayName=o.VY.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.__,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=o.__.displayName;let x=n.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,r.jsxs)(o.ck,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-slate-50",a),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(o.wU,{children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(o.eT,{children:n})]})});x.displayName=o.ck.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.Z0,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-slate-100 dark:bg-slate-800",a),...n})}).displayName=o.Z0.displayName},33804:function(e,t,a){a.d(t,{RM:function(){return l},SC:function(){return d},iA:function(){return o},pj:function(){return c},ss:function(){return i},xD:function(){return s}});var r=a(57437);a(2265);var n=a(93448);function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})}function s(e){let{className:t,...a}=e;return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,n.cn)("",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,n.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b border-border transition-colors",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,n.cn)("bg-muted text-foreground font-semibold border-b border-border p-3 text-left align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,n.cn)("p-3 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},80719:function(e,t,a){a.d(t,{AZ:function(){return c},Q$:function(){return u},bU:function(){return i},hz:function(){return l},jK:function(){return d},zN:function(){return s}});var r=a(46410),n=a(5978);async function o(e){try{if(!r.db)throw Error("Firebase 未初始化");let t={...e,changeDate:n.EK.fromDate(e.changeDate),createdAt:n.EK.fromDate(new Date)};return(await (0,n.addDoc)((0,n.collection)(r.db,"inventory_records"),t)).id}catch(e){throw console.error("建立庫存紀錄失敗:",e),Error("建立庫存紀錄失敗: ".concat(e instanceof Error?e.message:"未知錯誤"))}}async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(!r.db)throw Error("Firebase 未初始化");let{changeReason:t,operatorId:a,remarks:o,startDate:s,endDate:l,pageSize:d=10,lastDoc:i}=e,c=(0,n.query)((0,n.collection)(r.db,"inventory_records"),(0,n.Xo)("changeDate","desc"));t&&(c=(0,n.query)(c,(0,n.where)("changeReason","==",t))),a&&(c=(0,n.query)(c,(0,n.where)("operatorId","==",a))),o&&(c=(0,n.query)(c,(0,n.where)("remarks",">=",o),(0,n.where)("remarks","<=",o+""))),s&&(c=(0,n.query)(c,(0,n.where)("changeDate",">=",n.EK.fromDate(s)))),l&&(c=(0,n.query)(c,(0,n.where)("changeDate","<=",n.EK.fromDate(l)))),i&&(c=(0,n.query)(c,(0,n.TQ)(i))),c=(0,n.query)(c,(0,n.b9)(d));let u=await (0,n.getDocs)(c),f=[];u.forEach(e=>{let t=e.data();f.push({id:e.id,changeDate:t.changeDate.toDate(),changeReason:t.changeReason,operatorId:t.operatorId,operatorName:t.operatorName,remarks:t.remarks,relatedDocumentId:t.relatedDocumentId,relatedDocumentType:t.relatedDocumentType,details:t.details||[],createdAt:t.createdAt.toDate()})});let m=u.docs[u.docs.length-1]||null,p=u.docs.length===d;return{records:f,lastDoc:m,hasMore:p}}catch(e){throw console.error("查詢庫存紀錄失敗:",e),Error("查詢庫存紀錄失敗: ".concat(e instanceof Error?e.message:"未知錯誤"))}}async function l(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;try{if(!r.db)throw Error("Firebase 未初始化");let o=(0,n.query)((0,n.collection)(r.db,"inventory_records"),(0,n.Xo)("changeDate","desc"),(0,n.b9)(a)),s=await (0,n.getDocs)(o),l=[];return s.forEach(a=>{let r=a.data(),n=r.details||[];n.some(a=>a.itemId===e&&a.itemType===t)&&l.push({id:a.id,changeDate:r.changeDate.toDate(),changeReason:r.changeReason,operatorId:r.operatorId,operatorName:r.operatorName,remarks:r.remarks,relatedDocumentId:r.relatedDocumentId,relatedDocumentType:r.relatedDocumentType,details:n,createdAt:r.createdAt.toDate()})}),l}catch(e){throw console.error("查詢物料庫存歷史失敗:",e),Error("查詢物料庫存歷史失敗: ".concat(e instanceof Error?e.message:"未知錯誤"))}}async function d(e,t){return o({changeDate:new Date,changeReason:e,...t})}function i(e){return({purchase:"採購購入",workorder:"工單領料",inventory_check:"庫存盤點",manual_adjustment:"直接修改"})[e]||e}function c(e){return({material:"物料",fragrance:"香精"})[e]||e}function u(e,t,a){return e.details.find(e=>e.itemId===t&&e.itemType===a)||null}}}]);