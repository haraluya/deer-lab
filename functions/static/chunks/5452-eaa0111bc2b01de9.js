"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5452],{60044:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},56475:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},18930:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},85452:function(e,s,t){t.d(s,{J:function(){return A}});var a=t(57437),r=t(2265),l=t(5978),c=t(46410),n=t(93448),i=t(14438),o=t(99397);let d=(0,t(79205).Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var x=t(67782),m=t(15868),h=t(18930),g=t(62720),u=t(44794),j=t(56475),p=t(60044),y=t(12381),b=t(40279),f=t(69174),N=t(74291),v=t(80670),w=t(29501),C=t(13590),Z=t(67119),k=t(32060),S=t(33804),D=t(25751),M=t(83112);let z=Z.Ry({name:Z.Z_().min(1,"分類名稱不能為空"),type:Z.Km(["category","subCategory"])});function A(e){let{isOpen:s,onOpenChange:t}=e,[Z,A]=(0,r.useState)([]),[V,E]=(0,r.useState)(!0),[F,I]=(0,r.useState)(!1),[O,_]=(0,r.useState)(null),[q,L]=(0,r.useState)(!1),[P,W]=(0,r.useState)(null),[X,$]=(0,r.useState)(!1),[H,J]=(0,r.useState)(null),[K,T]=(0,r.useState)([]),[R,B]=(0,r.useState)(!1),[G,Q]=(0,r.useState)(!1),[Y,U]=(0,r.useState)(null),ee=(0,w.cI)({resolver:(0,C.F)(z),defaultValues:{name:"",type:"category"}}),es=async()=>{E(!0);try{if(!c.db)throw Error("Firebase 未初始化");let e=[];try{(await (0,l.getDocs)((0,l.collection)(c.db,"materialCategories"))).docs.forEach(s=>{let t=s.data();e.push({id:s.id,name:t.name,type:"category",usageCount:0,generatedId:t.id||function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s="";for(let t=0;t<2;t++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}()})})}catch(e){console.log("主分類集合不存在，跳過")}try{(await (0,l.getDocs)((0,l.collection)(c.db,"materialSubCategories"))).docs.forEach(s=>{let t=s.data();e.push({id:s.id,name:t.name,type:"subCategory",usageCount:0,generatedId:t.id||function(){let e="";for(let s=0;s<3;s++)e+=Math.floor(10*Math.random());return e}()})})}catch(e){console.log("細分分類集合不存在，跳過")}try{let s=await (0,l.getDocs)((0,l.collection)(c.db,"materials")),t=new Map,a=new Map;s.docs.forEach(e=>{let s=e.data();s.category&&t.set(s.category,(t.get(s.category)||0)+1),s.subCategory&&a.set(s.subCategory,(a.get(s.subCategory)||0)+1)}),e.forEach(e=>{"category"===e.type?e.usageCount=t.get(e.name)||0:e.usageCount=a.get(e.name)||0})}catch(e){console.log("無法統計使用數量")}let s=e.filter(e=>"category"===e.type).sort((e,s)=>e.name.localeCompare(s.name)),t=e.filter(e=>"subCategory"===e.type).sort((e,s)=>e.name.localeCompare(s.name));A([...s,...t])}catch(e){console.error("載入分類失敗:",e),i.Am.error("載入分類失敗")}finally{E(!1)}},et=async e=>{B(!0);try{let s;if(!c.db)throw Error("Firebase 未初始化");let t=(0,l.collection)(c.db,"materials");s="category"===e.type?(0,l.query)(t,(0,l.where)("category","==",e.name)):(0,l.query)(t,(0,l.where)("subCategory","==",e.name));let a=(await (0,l.getDocs)(s)).docs.map(e=>({id:e.id,...e.data()})),r=(await Promise.all(a.map(async e=>{if(e.supplierRef&&c.db)try{let s=await (0,l.getDocs)((0,l.query)((0,l.collection)(c.db,"suppliers"),(0,l.where)("__name__","==",e.supplierRef.id)));s.empty||(e.supplierName=s.docs[0].data().name)}catch(s){console.error("獲取供應商名稱失敗:",s),e.supplierName="讀取失敗"}return e}))).sort((e,s)=>e.name.localeCompare(s.name));T(r)}catch(e){console.error("載入物料資料失敗:",e),i.Am.error("載入物料資料失敗")}finally{B(!1)}},ea=async e=>{J(e),$(!0),await et(e)},er=e=>{U(e),Q(!0)};(0,r.useEffect)(()=>{s&&es()},[s]);let el=()=>{_(null),ee.reset({name:"",type:"category"}),I(!0)},ec=e=>{_(e),ee.reset({name:e.name,type:e.type}),I(!0)},en=e=>{if(e.usageCount>0){i.Am.error("無法刪除「".concat(e.name,"」，因為還有 ").concat(e.usageCount," 個物料正在使用此分類"));return}W(e),L(!0)},ei=async()=>{if(P)try{if(!c.db)throw Error("Firebase 未初始化");let e="category"===P.type?"materialCategories":"materialSubCategories";await (0,l.deleteDoc)((0,l.doc)(c.db,e,P.id)),i.Am.success("分類「".concat(P.name,"」已刪除")),es()}catch(e){console.error("刪除分類失敗:",e),i.Am.error("刪除分類失敗")}finally{L(!1),W(null)}},eo=async e=>{try{if(!c.db)throw Error("Firebase 未初始化");if(O){let s;let t="category"===O.type?"materialCategories":"materialSubCategories",a=O.name;await (0,l.r7)((0,l.doc)(c.db,t,O.id),{name:e.name,updatedAt:new Date});let r=(0,l.collection)(c.db,"materials");s="category"===O.type?(0,l.query)(r,(0,l.where)("category","==",a)):(0,l.query)(r,(0,l.where)("subCategory","==",a));let n=await (0,l.getDocs)(s),o=(0,l.qs)(c.db);n.docs.forEach(s=>{let t="category"===O.type?{category:e.name}:{subCategory:e.name};o.update(s.ref,t)}),n.empty||(await o.commit(),console.log("已更新 ".concat(n.size," 個物料的").concat("category"===O.type?"主分類":"細分分類","名稱"))),i.Am.success("分類「".concat(e.name,"」已更新，並同步更新了 ").concat(n.size," 個相關物料"))}else{let s="";s="category"===e.type?await (0,n.SF)(c.db):await (0,n.NQ)(c.db);let t="category"===e.type?"materialCategories":"materialSubCategories",a={id:s,name:e.name,type:e.type,createdAt:new Date,..."subCategory"===e.type&&{parentCategory:"未指定"}};await (0,l.addDoc)((0,l.collection)(c.db,t),a),console.log("新增".concat("category"===e.type?"主分類":"細分分類","，ID: ").concat(s)),i.Am.success("分類「".concat(e.name,"」已新增，ID: ").concat(s))}I(!1),es()}catch(e){console.error("儲存分類失敗:",e),i.Am.error("儲存分類失敗")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.Vq,{open:s,onOpenChange:t,children:(0,a.jsxs)(N.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(N.fK,{children:[(0,a.jsx)(N.$N,{className:"text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"物料分類管理"}),(0,a.jsx)(N.Be,{children:"管理物料分類與細分分類"})]}),(0,a.jsx)("div",{className:"flex justify-end mb-4",children:(0,a.jsxs)(y.z,{onClick:el,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,a.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"新增分類"]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[Z.filter(e=>"category"===e.type).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(d,{className:"h-5 w-5 text-blue-600"}),"主分類"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Z.filter(e=>"category"===e.type).map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-blue-100 p-4 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:()=>ea(e),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(d,{className:"h-4 w-4 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["主分類 ID:",(0,a.jsx)("span",{className:"font-mono bg-blue-100 px-1 rounded ml-1",children:e.generatedId||"待生成"})]})]})]}),(0,a.jsxs)(k.h_,{children:[(0,a.jsx)(k.$F,{asChild:!0,children:(0,a.jsx)(y.z,{variant:"ghost",className:"h-6 w-6 p-0",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(x.Z,{className:"h-3 w-3"})})}),(0,a.jsxs)(k.AW,{align:"end",children:[(0,a.jsx)(k.Ju,{children:"操作"}),(0,a.jsx)(k.VD,{}),(0,a.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),ec(e)},children:[(0,a.jsx)(m.Z,{className:"h-3 w-3 mr-2"}),"編輯分類"]}),(0,a.jsx)(k.VD,{}),(0,a.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),en(e)},className:"text-red-600 focus:text-red-600",disabled:e.usageCount>0,children:[(0,a.jsx)(h.Z,{className:"h-3 w-3 mr-2"}),"刪除分類"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-3 w-3 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"分類類型"}),(0,a.jsx)(f.C,{className:"text-xs bg-blue-100 text-blue-800 border-blue-200",children:"主分類"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-3 w-3 text-purple-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"使用數量"}),(0,a.jsxs)("p",{className:"text-xs font-medium text-gray-900",children:[e.usageCount," 個物料"]})]})]})]})]},e.id))})]}),Z.filter(e=>"subCategory"===e.type).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}),"細分分類"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Z.filter(e=>"subCategory"===e.type).map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-green-100 p-4 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:()=>ea(e),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(j.Z,{className:"h-4 w-4 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["細分分類 ID:",(0,a.jsx)("span",{className:"font-mono bg-green-100 px-1 rounded ml-1",children:e.generatedId||"待生成"})]})]})]}),(0,a.jsxs)(k.h_,{children:[(0,a.jsx)(k.$F,{asChild:!0,children:(0,a.jsx)(y.z,{variant:"ghost",className:"h-6 w-6 p-0",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(x.Z,{className:"h-3 w-3"})})}),(0,a.jsxs)(k.AW,{align:"end",children:[(0,a.jsx)(k.Ju,{children:"操作"}),(0,a.jsx)(k.VD,{}),(0,a.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),ec(e)},children:[(0,a.jsx)(m.Z,{className:"h-3 w-3 mr-2"}),"編輯分類"]}),(0,a.jsx)(k.VD,{}),(0,a.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),en(e)},className:"text-red-600 focus:text-red-600",disabled:e.usageCount>0,children:[(0,a.jsx)(h.Z,{className:"h-3 w-3 mr-2"}),"刪除分類"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-3 w-3 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"分類類型"}),(0,a.jsx)(f.C,{className:"text-xs bg-green-100 text-green-800 border-green-200",children:"細分分類"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-3 w-3 text-purple-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"使用數量"}),(0,a.jsxs)("p",{className:"text-xs font-medium text-gray-900",children:[e.usageCount," 個物料"]})]})]})]})]},e.id))})]}),V&&(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-4 animate-pulse",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"})]})]},s))}),!V&&0===Z.length&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:(0,a.jsx)(g.Z,{className:"h-6 w-6 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"沒有分類資料"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"開始建立第一個分類來管理物料"}),(0,a.jsxs)(y.z,{onClick:el,variant:"outline",size:"sm",className:"border-teal-200 text-teal-600 hover:bg-teal-50",children:[(0,a.jsx)(o.Z,{className:"mr-2 h-3 w-3"}),"新增分類"]})]})]})]})}),(0,a.jsx)(N.Vq,{open:F,onOpenChange:I,children:(0,a.jsxs)(N.cZ,{children:[(0,a.jsxs)(N.fK,{children:[(0,a.jsx)(N.$N,{children:O?"編輯分類":"新增分類"}),(0,a.jsx)(N.Be,{children:O?"修改分類資訊":"建立新的物料分類"})]}),(0,a.jsx)(v.l0,{...ee,children:(0,a.jsxs)("form",{onSubmit:ee.handleSubmit(eo),className:"space-y-4",children:[(0,a.jsx)(v.Wi,{control:ee.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(v.xJ,{children:[(0,a.jsx)(v.lX,{children:"分類名稱"}),(0,a.jsx)(v.NI,{children:(0,a.jsx)(b.I,{placeholder:"輸入分類名稱",...s})}),(0,a.jsx)(v.zG,{})]})}}),(0,a.jsx)(v.Wi,{control:ee.control,name:"type",render:e=>{let{field:s}=e;return(0,a.jsxs)(v.xJ,{children:[(0,a.jsx)(v.lX,{children:"分類類型"}),(0,a.jsx)(v.NI,{children:(0,a.jsxs)("select",{...s,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500",children:[(0,a.jsx)("option",{value:"category",children:"主分類 (2位大寫英文)"}),(0,a.jsx)("option",{value:"subCategory",children:"細分分類 (3位數字)"})]})}),(0,a.jsx)(v.zG,{})]})}}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(y.z,{type:"button",variant:"outline",onClick:()=>I(!1),children:"取消"}),(0,a.jsx)(y.z,{type:"submit",children:O?"更新":"新增"})]})]})})]})}),(0,a.jsx)(N.Vq,{open:X,onOpenChange:$,children:(0,a.jsxs)(N.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-white",children:[(0,a.jsxs)(N.fK,{className:"pb-4 border-b border-gray-200",children:[(0,a.jsxs)(N.$N,{className:"flex items-center gap-3 text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"h-5 w-5 text-white"})}),"分類詳情"]}),(0,a.jsxs)("p",{className:"text-gray-600 mt-2",children:[(null==H?void 0:H.type)==="category"?"主分類":"細分分類","，共 ",null==H?void 0:H.usageCount," 個物料使用此分類"]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[H&&(0,a.jsxs)("div",{className:"space-y-6 p-6 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl border border-teal-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-3 text-teal-800",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"h-4 w-4 text-teal-600"})}),"分類資訊"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-semibold text-gray-700",children:"分類名稱"}),(0,a.jsx)("div",{className:"text-lg font-medium text-gray-900",children:H.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-semibold text-gray-700",children:"分類類型"}),(0,a.jsx)("div",{className:"text-lg",children:(0,a.jsx)(f.C,{className:"".concat("category"===H.type?"bg-teal-100 text-teal-800 border-teal-200":"bg-cyan-100 text-cyan-800 border-cyan-200"),children:"category"===H.type?"主分類":"細分分類"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-semibold text-gray-700",children:"使用數量"}),(0,a.jsxs)("div",{className:"text-lg font-medium text-gray-900",children:[H.usageCount," 個物料"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 text-gray-800",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),"使用此分類的物料"]}),R?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-teal-200 rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 w-10 h-10 border-4 border-transparent border-t-teal-600 rounded-full animate-spin"})]}),(0,a.jsx)("span",{className:"mt-3 text-sm text-gray-600 font-medium",children:"載入物料資料中..."})]}):K.length>0?(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,a.jsxs)(S.iA,{children:[(0,a.jsx)(S.xD,{children:(0,a.jsxs)(S.SC,{children:[(0,a.jsx)(S.ss,{children:"物料資訊"}),(0,a.jsx)(S.ss,{children:"分類"}),(0,a.jsx)(S.ss,{children:"供應商"}),(0,a.jsx)(S.ss,{children:"庫存"}),(0,a.jsx)(S.ss,{children:"單位"})]})}),(0,a.jsx)(S.RM,{children:K.map(e=>(0,a.jsxs)(S.SC,{className:"hover:bg-teal-50/50 transition-colors duration-200 cursor-pointer",onClick:()=>er(e),children:[(0,a.jsx)(S.pj,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"h-4 w-4 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["代號: ",e.code]})]})]})}),(0,a.jsx)(S.pj,{children:(0,a.jsxs)("div",{className:"space-y-1",children:[e.category&&(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"主分類:"})," ",e.category]}),e.subCategory&&(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"細分類:"})," ",e.subCategory]})]})}),(0,a.jsx)(S.pj,{children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-sm text-gray-900",children:e.supplierName||"未指定"})})}),(0,a.jsx)(S.pj,{children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-sm font-medium ".concat(e.currentStock>0?"text-green-600":"text-red-600"),children:e.currentStock})})}),(0,a.jsx)(S.pj,{children:(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.unit||"-"})})]},e.id))})]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:(0,a.jsx)(u.Z,{className:"h-6 w-6 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900 mb-1",children:"沒有使用此分類的物料"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 text-center",children:["目前沒有物料使用「",null==H?void 0:H.name,"」分類"]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,a.jsx)(y.z,{variant:"outline",onClick:()=>$(!1),children:"關閉"}),H&&(0,a.jsxs)(y.z,{onClick:()=>{$(!1),setTimeout(()=>{ec(H)},100)},className:"bg-teal-600 hover:bg-teal-700 text-white",children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"編輯分類"]})]})]})}),(0,a.jsx)(M.O,{isOpen:G,onOpenChange:Q,title:"物料詳情",subtitle:Y?"查看物料「".concat(Y.name,"」的詳細資訊"):"",sections:Y?[{title:"基本資訊",icon:(0,a.jsx)(u.Z,{className:"h-4 w-4"}),color:"blue",fields:[{label:"物料名稱",value:Y.name,icon:(0,a.jsx)(u.Z,{className:"h-3 w-3"})},{label:"物料代號",value:Y.code,icon:(0,a.jsx)(g.Z,{className:"h-3 w-3"})},{label:"單位",value:Y.unit||"-",icon:(0,a.jsx)(u.Z,{className:"h-3 w-3"})}]},{title:"分類資訊",icon:(0,a.jsx)(g.Z,{className:"h-4 w-4"}),color:"green",fields:[{label:"主分類",value:Y.category||"-",icon:(0,a.jsx)(g.Z,{className:"h-3 w-3"})},{label:"細分分類",value:Y.subCategory||"-",icon:(0,a.jsx)(g.Z,{className:"h-3 w-3"})}]},{title:"庫存資訊",icon:(0,a.jsx)(u.Z,{className:"h-4 w-4"}),color:"purple",fields:[{label:"當前庫存",value:Y.currentStock,type:"number",icon:(0,a.jsx)(u.Z,{className:"h-3 w-3"})}]},{title:"供應商資訊",icon:(0,a.jsx)(p.Z,{className:"h-4 w-4"}),color:"yellow",fields:[{label:"供應商",value:Y.supplierName||"未指定",icon:(0,a.jsx)(p.Z,{className:"h-3 w-3"})}]}]:[],actions:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(y.z,{variant:"outline",onClick:()=>Q(!1),children:"關閉"}),Y&&(0,a.jsx)(y.z,{onClick:()=>{Q(!1)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:"編輯物料"})]})}),(0,a.jsx)(D.Q,{isOpen:q,onOpenChange:L,onConfirm:ei,title:"確認刪除",description:"您確定要刪除分類「".concat(null==P?void 0:P.name,"」嗎？此操作無法復原。")})]})}},83112:function(e,s,t){t.d(s,{O:function(){return n}});var a=t(57437),r=t(74291),l=t(69174),c=t(79820);function n(e){let{isOpen:s,onOpenChange:t,title:n,subtitle:i,sections:o,actions:d}=e,x=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(null==e||""===e)return(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"});switch(s){case"date":if(null==e?void 0:e.toDate)return new Date(e.toDate()).toLocaleString("zh-TW");return new Date(e).toLocaleString("zh-TW");case"badge":return(0,a.jsx)(l.C,{variant:(e=>{switch(e.toLowerCase()){case"active":case"啟用":return"default";case"inactive":case"停用":return"secondary";case"discontinued":case"已下架":return"destructive";default:return"outline"}})(e),children:(e=>{switch(e.toLowerCase()){case"active":return"啟用";case"inactive":return"停用";case"discontinued":return"已下架";default:return e}})(e)});case"currency":return"NT$ ".concat(Math.round(Number(e)).toLocaleString());case"percentage":return"".concat(e,"%");case"number":return Number(e).toLocaleString();default:return String(e)}};return(0,a.jsx)(r.Vq,{open:s,onOpenChange:t,children:(0,a.jsxs)(r.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto","aria-describedby":"detail-view-dialog-description",children:[(0,a.jsxs)(r.fK,{children:[(0,a.jsx)(r.$N,{className:"text-xl flex items-center gap-2",children:n}),i&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",id:"detail-view-dialog-description",children:i})]}),(0,a.jsx)("div",{className:"space-y-6",children:o.map((e,s)=>(0,a.jsxs)(c.Zb,{className:(e=>{switch(e){case"blue":return"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200";case"green":return"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200";case"purple":return"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200";case"yellow":return"bg-gradient-to-r from-yellow-50 to-orange-50 border-yellow-200";case"red":return"bg-gradient-to-r from-red-50 to-pink-50 border-red-200";case"gray":return"bg-gradient-to-r from-gray-50 to-slate-50 border-gray-200";default:return"bg-white border-gray-200"}})(e.color),children:[(0,a.jsx)(c.Ol,{className:"pb-3",children:(0,a.jsxs)(c.ll,{className:"text-lg font-bold flex items-center gap-3 ".concat((e=>{switch(e){case"blue":return"text-blue-800";case"green":return"text-green-800";case"purple":return"text-purple-800";case"yellow":return"text-yellow-800";case"red":return"text-red-800";default:return"text-foreground"}})(e.color)),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat("blue"===e.color?"bg-blue-100":"green"===e.color?"bg-green-100":"purple"===e.color?"bg-purple-100":"yellow"===e.color?"bg-yellow-100":"red"===e.color?"bg-red-100":(e.color,"bg-gray-100")),children:(0,a.jsx)("div",{className:"".concat("blue"===e.color?"text-blue-600":"green"===e.color?"text-green-600":"purple"===e.color?"text-purple-600":"yellow"===e.color?"text-yellow-600":"red"===e.color?"text-red-600":(e.color,"text-gray-600")),children:e.icon})}),e.title]})}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.fields.map((e,s)=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[e.icon,(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:e.label})]}),(0,a.jsx)("div",{className:"text-sm",children:x(e.value,e.type)})]},s))})})]},s))}),d&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"border-t pt-4",children:(0,a.jsx)("div",{className:"flex justify-end gap-2",children:d})})})]})})}}}]);