"use strict";exports.id=4791,exports.ids=[4791],exports.modules={28932:(e,s,a)=>{a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},98091:(e,s,a)=>{a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},54791:(e,s,a)=>{a.d(s,{J:()=>z});var t=a(10326),r=a(17577),l=a(76),c=a(90445),n=a(51223),i=a(85999),d=a(83855);let o=(0,a(62881).Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var x=a(15919),m=a(69508),h=a(98091),g=a(40765),u=a(48705),j=a(28932),p=a(38787),y=a(91664),b=a(41190),N=a(38443),f=a(24118),v=a(9969),w=a(74723),C=a(74064),Z=a(770),k=a(10143),S=a(41156),D=a(13898),$=a(58580);let A=Z.Ry({name:Z.Z_().min(1,"分類名稱不能為空"),type:Z.Km(["category","subCategory"])});function z({isOpen:e,onOpenChange:s}){let[a,Z]=(0,r.useState)([]),[z,V]=(0,r.useState)(!0),[F,I]=(0,r.useState)(!1),[M,O]=(0,r.useState)(null),[q,E]=(0,r.useState)(!1),[L,P]=(0,r.useState)(null),[W,X]=(0,r.useState)(!1),[_,H]=(0,r.useState)(null),[J,K]=(0,r.useState)([]),[T,R]=(0,r.useState)(!1),[B,G]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(null),U=(0,w.cI)({resolver:(0,C.F)(A),defaultValues:{name:"",type:"category"}}),ee=async()=>{V(!0);try{if(!c.db)throw Error("Firebase 未初始化");let e=[];try{(await (0,l.getDocs)((0,l.collection)(c.db,"materialCategories"))).docs.forEach(s=>{let a=s.data();e.push({id:s.id,name:a.name,type:"category",usageCount:0,generatedId:a.id||function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s="";for(let a=0;a<2;a++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}()})})}catch(e){console.log("主分類集合不存在，跳過")}try{(await (0,l.getDocs)((0,l.collection)(c.db,"materialSubCategories"))).docs.forEach(s=>{let a=s.data();e.push({id:s.id,name:a.name,type:"subCategory",usageCount:0,generatedId:a.id||function(){let e="";for(let s=0;s<3;s++)e+=Math.floor(10*Math.random());return e}()})})}catch(e){console.log("細分分類集合不存在，跳過")}try{let s=await (0,l.getDocs)((0,l.collection)(c.db,"materials")),a=new Map,t=new Map;s.docs.forEach(e=>{let s=e.data();s.category&&a.set(s.category,(a.get(s.category)||0)+1),s.subCategory&&t.set(s.subCategory,(t.get(s.subCategory)||0)+1)}),e.forEach(e=>{"category"===e.type?e.usageCount=a.get(e.name)||0:e.usageCount=t.get(e.name)||0})}catch(e){console.log("無法統計使用數量")}let s=e.filter(e=>"category"===e.type).sort((e,s)=>e.name.localeCompare(s.name)),a=e.filter(e=>"subCategory"===e.type).sort((e,s)=>e.name.localeCompare(s.name));Z([...s,...a])}catch(e){console.error("載入分類失敗:",e),i.Am.error("載入分類失敗")}finally{V(!1)}},es=async e=>{R(!0);try{let s;if(!c.db)throw Error("Firebase 未初始化");let a=(0,l.collection)(c.db,"materials");s="category"===e.type?(0,l.query)(a,(0,l.where)("category","==",e.name)):(0,l.query)(a,(0,l.where)("subCategory","==",e.name));let t=(await (0,l.getDocs)(s)).docs.map(e=>({id:e.id,...e.data()})),r=(await Promise.all(t.map(async e=>{if(e.supplierRef&&c.db)try{let s=await (0,l.getDocs)((0,l.query)((0,l.collection)(c.db,"suppliers"),(0,l.where)("__name__","==",e.supplierRef.id)));s.empty||(e.supplierName=s.docs[0].data().name)}catch(s){console.error("獲取供應商名稱失敗:",s),e.supplierName="讀取失敗"}return e}))).sort((e,s)=>e.name.localeCompare(s.name));K(r)}catch(e){console.error("載入物料資料失敗:",e),i.Am.error("載入物料資料失敗")}finally{R(!1)}},ea=async e=>{H(e),X(!0),await es(e)},et=e=>{Y(e),G(!0)},er=()=>{O(null),U.reset({name:"",type:"category"}),I(!0)},el=e=>{O(e),U.reset({name:e.name,type:e.type}),I(!0)},ec=e=>{if(e.usageCount>0){i.Am.error(`無法刪除「${e.name}」，因為還有 ${e.usageCount} 個物料正在使用此分類`);return}P(e),E(!0)},en=async()=>{if(L)try{if(!c.db)throw Error("Firebase 未初始化");let e="category"===L.type?"materialCategories":"materialSubCategories";await (0,l.deleteDoc)((0,l.doc)(c.db,e,L.id)),i.Am.success(`分類「${L.name}」已刪除`),ee()}catch(e){console.error("刪除分類失敗:",e),i.Am.error("刪除分類失敗")}finally{E(!1),P(null)}},ei=async e=>{try{if(!c.db)throw Error("Firebase 未初始化");if(M){let s;let a="category"===M.type?"materialCategories":"materialSubCategories",t=M.name;await (0,l.r7)((0,l.doc)(c.db,a,M.id),{name:e.name,updatedAt:new Date});let r=(0,l.collection)(c.db,"materials");s="category"===M.type?(0,l.query)(r,(0,l.where)("category","==",t)):(0,l.query)(r,(0,l.where)("subCategory","==",t));let n=await (0,l.getDocs)(s),d=(0,l.qs)(c.db);n.docs.forEach(s=>{let a="category"===M.type?{category:e.name}:{subCategory:e.name};d.update(s.ref,a)}),n.empty||(await d.commit(),console.log(`已更新 ${n.size} 個物料的${"category"===M.type?"主分類":"細分分類"}名稱`)),i.Am.success(`分類「${e.name}」已更新，並同步更新了 ${n.size} 個相關物料`)}else{let s="";s="category"===e.type?await (0,n.SF)(c.db):await (0,n.NQ)(c.db);let a="category"===e.type?"materialCategories":"materialSubCategories",t={id:s,name:e.name,type:e.type,createdAt:new Date,..."subCategory"===e.type&&{parentCategory:"未指定"}};await (0,l.addDoc)((0,l.collection)(c.db,a),t),console.log(`新增${"category"===e.type?"主分類":"細分分類"}，ID: ${s}`),i.Am.success(`分類「${e.name}」已新增，ID: ${s}`)}I(!1),ee()}catch(e){console.error("儲存分類失敗:",e),i.Am.error("儲存分類失敗")}};return(0,t.jsxs)(t.Fragment,{children:[t.jsx(f.Vq,{open:e,onOpenChange:s,children:(0,t.jsxs)(f.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(f.fK,{children:[t.jsx(f.$N,{className:"text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"物料分類管理"}),t.jsx(f.Be,{children:"管理物料分類與細分分類"})]}),t.jsx("div",{className:"flex justify-end mb-4",children:(0,t.jsxs)(y.z,{onClick:er,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[t.jsx(d.Z,{className:"mr-2 h-4 w-4"}),"新增分類"]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[a.filter(e=>"category"===e.type).length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(o,{className:"h-5 w-5 text-blue-600"}),"主分類"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.filter(e=>"category"===e.type).map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-blue-100 p-4 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:()=>ea(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center",children:t.jsx(o,{className:"h-4 w-4 text-white"})}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["主分類 ID:",t.jsx("span",{className:"font-mono bg-blue-100 px-1 rounded ml-1",children:e.generatedId||"待生成"})]})]})]}),(0,t.jsxs)(k.h_,{children:[t.jsx(k.$F,{asChild:!0,children:t.jsx(y.z,{variant:"ghost",className:"h-6 w-6 p-0",onClick:e=>e.stopPropagation(),children:t.jsx(x.Z,{className:"h-3 w-3"})})}),(0,t.jsxs)(k.AW,{align:"end",children:[t.jsx(k.Ju,{children:"操作"}),t.jsx(k.VD,{}),(0,t.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),el(e)},children:[t.jsx(m.Z,{className:"h-3 w-3 mr-2"}),"編輯分類"]}),t.jsx(k.VD,{}),(0,t.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),ec(e)},className:"text-red-600 focus:text-red-600",disabled:e.usageCount>0,children:[t.jsx(h.Z,{className:"h-3 w-3 mr-2"}),"刪除分類"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(g.Z,{className:"h-3 w-3 text-blue-600"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs text-gray-500",children:"分類類型"}),t.jsx(N.C,{className:"text-xs bg-blue-100 text-blue-800 border-blue-200",children:"主分類"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(u.Z,{className:"h-3 w-3 text-purple-600"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs text-gray-500",children:"使用數量"}),(0,t.jsxs)("p",{className:"text-xs font-medium text-gray-900",children:[e.usageCount," 個物料"]})]})]})]})]},e.id))})]}),a.filter(e=>"subCategory"===e.type).length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(j.Z,{className:"h-5 w-5 text-green-600"}),"細分分類"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.filter(e=>"subCategory"===e.type).map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-green-100 p-4 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:()=>ea(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:t.jsx(j.Z,{className:"h-4 w-4 text-white"})}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["細分分類 ID:",t.jsx("span",{className:"font-mono bg-green-100 px-1 rounded ml-1",children:e.generatedId||"待生成"})]})]})]}),(0,t.jsxs)(k.h_,{children:[t.jsx(k.$F,{asChild:!0,children:t.jsx(y.z,{variant:"ghost",className:"h-6 w-6 p-0",onClick:e=>e.stopPropagation(),children:t.jsx(x.Z,{className:"h-3 w-3"})})}),(0,t.jsxs)(k.AW,{align:"end",children:[t.jsx(k.Ju,{children:"操作"}),t.jsx(k.VD,{}),(0,t.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),el(e)},children:[t.jsx(m.Z,{className:"h-3 w-3 mr-2"}),"編輯分類"]}),t.jsx(k.VD,{}),(0,t.jsxs)(k.Xi,{onClick:s=>{s.preventDefault(),s.stopPropagation(),ec(e)},className:"text-red-600 focus:text-red-600",disabled:e.usageCount>0,children:[t.jsx(h.Z,{className:"h-3 w-3 mr-2"}),"刪除分類"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(g.Z,{className:"h-3 w-3 text-green-600"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs text-gray-500",children:"分類類型"}),t.jsx(N.C,{className:"text-xs bg-green-100 text-green-800 border-green-200",children:"細分分類"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(u.Z,{className:"h-3 w-3 text-purple-600"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs text-gray-500",children:"使用數量"}),(0,t.jsxs)("p",{className:"text-xs font-medium text-gray-900",children:[e.usageCount," 個物料"]})]})]})]})]},e.id))})]}),z&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((e,s)=>(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-4 animate-pulse",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-3 bg-gray-200 rounded"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-4/5"})]})]},s))}),!z&&0===a.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[t.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:t.jsx(g.Z,{className:"h-6 w-6 text-gray-400"})}),t.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"沒有分類資料"}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"開始建立第一個分類來管理物料"}),(0,t.jsxs)(y.z,{onClick:er,variant:"outline",size:"sm",className:"border-teal-200 text-teal-600 hover:bg-teal-50",children:[t.jsx(d.Z,{className:"mr-2 h-3 w-3"}),"新增分類"]})]})]})]})}),t.jsx(f.Vq,{open:F,onOpenChange:I,children:(0,t.jsxs)(f.cZ,{children:[(0,t.jsxs)(f.fK,{children:[t.jsx(f.$N,{children:M?"編輯分類":"新增分類"}),t.jsx(f.Be,{children:M?"修改分類資訊":"建立新的物料分類"})]}),t.jsx(v.l0,{...U,children:(0,t.jsxs)("form",{onSubmit:U.handleSubmit(ei),className:"space-y-4",children:[t.jsx(v.Wi,{control:U.control,name:"name",render:({field:e})=>(0,t.jsxs)(v.xJ,{children:[t.jsx(v.lX,{children:"分類名稱"}),t.jsx(v.NI,{children:t.jsx(b.I,{placeholder:"輸入分類名稱",...e})}),t.jsx(v.zG,{})]})}),t.jsx(v.Wi,{control:U.control,name:"type",render:({field:e})=>(0,t.jsxs)(v.xJ,{children:[t.jsx(v.lX,{children:"分類類型"}),t.jsx(v.NI,{children:(0,t.jsxs)("select",{...e,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-teal-500 focus:border-teal-500",children:[t.jsx("option",{value:"category",children:"主分類 (2位大寫英文)"}),t.jsx("option",{value:"subCategory",children:"細分分類 (3位數字)"})]})}),t.jsx(v.zG,{})]})}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(y.z,{type:"button",variant:"outline",onClick:()=>I(!1),children:"取消"}),t.jsx(y.z,{type:"submit",children:M?"更新":"新增"})]})]})})]})}),t.jsx(f.Vq,{open:W,onOpenChange:X,children:(0,t.jsxs)(f.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-white",children:[(0,t.jsxs)(f.fK,{className:"pb-4 border-b border-gray-200",children:[(0,t.jsxs)(f.$N,{className:"flex items-center gap-3 text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center",children:t.jsx(g.Z,{className:"h-5 w-5 text-white"})}),"分類詳情"]}),(0,t.jsxs)("p",{className:"text-gray-600 mt-2",children:[_?.type==="category"?"主分類":"細分分類","，共 ",_?.usageCount," 個物料使用此分類"]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[_&&(0,t.jsxs)("div",{className:"space-y-6 p-6 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl border border-teal-200 shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-3 text-teal-800",children:[t.jsx("div",{className:"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center",children:t.jsx(g.Z,{className:"h-4 w-4 text-teal-600"})}),"分類資訊"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"分類名稱"}),t.jsx("div",{className:"text-lg font-medium text-gray-900",children:_.name})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"分類類型"}),t.jsx("div",{className:"text-lg",children:t.jsx(N.C,{className:`${"category"===_.type?"bg-teal-100 text-teal-800 border-teal-200":"bg-cyan-100 text-cyan-800 border-cyan-200"}`,children:"category"===_.type?"主分類":"細分分類"})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"使用數量"}),(0,t.jsxs)("div",{className:"text-lg font-medium text-gray-900",children:[_.usageCount," 個物料"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2 text-gray-800",children:[t.jsx(u.Z,{className:"h-4 w-4"}),"使用此分類的物料"]}),T?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsxs)("div",{className:"relative",children:[t.jsx("div",{className:"w-10 h-10 border-4 border-teal-200 rounded-full animate-spin"}),t.jsx("div",{className:"absolute top-0 left-0 w-10 h-10 border-4 border-transparent border-t-teal-600 rounded-full animate-spin"})]}),t.jsx("span",{className:"mt-3 text-sm text-gray-600 font-medium",children:"載入物料資料中..."})]}):J.length>0?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,t.jsxs)(S.iA,{children:[t.jsx(S.xD,{children:(0,t.jsxs)(S.SC,{children:[t.jsx(S.ss,{children:"物料資訊"}),t.jsx(S.ss,{children:"分類"}),t.jsx(S.ss,{children:"供應商"}),t.jsx(S.ss,{children:"庫存"}),t.jsx(S.ss,{children:"單位"})]})}),t.jsx(S.RM,{children:J.map(e=>(0,t.jsxs)(S.SC,{className:"hover:bg-teal-50/50 transition-colors duration-200 cursor-pointer",onClick:()=>et(e),children:[t.jsx(S.pj,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center",children:t.jsx(u.Z,{className:"h-4 w-4 text-white"})}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["代號: ",e.code]})]})]})}),t.jsx(S.pj,{children:(0,t.jsxs)("div",{className:"space-y-1",children:[e.category&&(0,t.jsxs)("div",{className:"text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"主分類:"})," ",e.category]}),e.subCategory&&(0,t.jsxs)("div",{className:"text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"細分類:"})," ",e.subCategory]})]})}),t.jsx(S.pj,{children:t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:"text-sm text-gray-900",children:e.supplierName||"未指定"})})}),t.jsx(S.pj,{children:t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:`text-sm font-medium ${e.currentStock>0?"text-green-600":"text-red-600"}`,children:e.currentStock})})}),t.jsx(S.pj,{children:t.jsx("span",{className:"text-sm text-gray-600",children:e.unit||"-"})})]},e.id))})]})}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:t.jsx(u.Z,{className:"h-6 w-6 text-gray-400"})}),t.jsx("h3",{className:"text-base font-medium text-gray-900 mb-1",children:"沒有使用此分類的物料"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 text-center",children:["目前沒有物料使用「",_?.name,"」分類"]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[t.jsx(y.z,{variant:"outline",onClick:()=>X(!1),children:"關閉"}),_&&(0,t.jsxs)(y.z,{onClick:()=>{X(!1),setTimeout(()=>{el(_)},100)},className:"bg-teal-600 hover:bg-teal-700 text-white",children:[t.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"編輯分類"]})]})]})}),t.jsx($.O,{isOpen:B,onOpenChange:G,title:"物料詳情",subtitle:Q?`查看物料「${Q.name}」的詳細資訊`:"",sections:Q?[{title:"基本資訊",icon:t.jsx(u.Z,{className:"h-4 w-4"}),color:"blue",fields:[{label:"物料名稱",value:Q.name,icon:t.jsx(u.Z,{className:"h-3 w-3"})},{label:"物料代號",value:Q.code,icon:t.jsx(g.Z,{className:"h-3 w-3"})},{label:"單位",value:Q.unit||"-",icon:t.jsx(u.Z,{className:"h-3 w-3"})}]},{title:"分類資訊",icon:t.jsx(g.Z,{className:"h-4 w-4"}),color:"green",fields:[{label:"主分類",value:Q.category||"-",icon:t.jsx(g.Z,{className:"h-3 w-3"})},{label:"細分分類",value:Q.subCategory||"-",icon:t.jsx(g.Z,{className:"h-3 w-3"})}]},{title:"庫存資訊",icon:t.jsx(u.Z,{className:"h-4 w-4"}),color:"purple",fields:[{label:"當前庫存",value:Q.currentStock,type:"number",icon:t.jsx(u.Z,{className:"h-3 w-3"})}]},{title:"供應商資訊",icon:t.jsx(p.Z,{className:"h-4 w-4"}),color:"yellow",fields:[{label:"供應商",value:Q.supplierName||"未指定",icon:t.jsx(p.Z,{className:"h-3 w-3"})}]}]:[],actions:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(y.z,{variant:"outline",onClick:()=>G(!1),children:"關閉"}),Q&&t.jsx(y.z,{onClick:()=>{G(!1)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:"編輯物料"})]})}),t.jsx(D.Q,{isOpen:q,onOpenChange:E,onConfirm:en,title:"確認刪除",description:`您確定要刪除分類「${L?.name}」嗎？此操作無法復原。`})]})}},58580:(e,s,a)=>{a.d(s,{O:()=>n});var t=a(10326),r=a(24118),l=a(38443),c=a(29752);function n({isOpen:e,onOpenChange:s,title:a,subtitle:n,sections:i,actions:d}){let o=(e,s="text")=>{if(null==e||""===e)return t.jsx("span",{className:"text-muted-foreground",children:"-"});switch(s){case"date":if(e?.toDate)return new Date(e.toDate()).toLocaleString("zh-TW");return new Date(e).toLocaleString("zh-TW");case"badge":return t.jsx(l.C,{variant:(e=>{switch(e.toLowerCase()){case"active":case"啟用":return"default";case"inactive":case"停用":return"secondary";case"discontinued":case"已下架":return"destructive";default:return"outline"}})(e),children:(e=>{switch(e.toLowerCase()){case"active":return"啟用";case"inactive":return"停用";case"discontinued":return"已下架";default:return e}})(e)});case"currency":return`NT$ ${Math.round(Number(e)).toLocaleString()}`;case"percentage":return`${e}%`;case"number":return Number(e).toLocaleString();default:return String(e)}};return t.jsx(r.Vq,{open:e,onOpenChange:s,children:(0,t.jsxs)(r.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto","aria-describedby":"detail-view-dialog-description",children:[(0,t.jsxs)(r.fK,{children:[t.jsx(r.$N,{className:"text-xl flex items-center gap-2",children:a}),n&&t.jsx("p",{className:"text-sm text-muted-foreground",id:"detail-view-dialog-description",children:n})]}),t.jsx("div",{className:"space-y-6",children:i.map((e,s)=>(0,t.jsxs)(c.Zb,{className:(e=>{switch(e){case"blue":return"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200";case"green":return"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200";case"purple":return"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200";case"yellow":return"bg-gradient-to-r from-yellow-50 to-orange-50 border-yellow-200";case"red":return"bg-gradient-to-r from-red-50 to-pink-50 border-red-200";case"gray":return"bg-gradient-to-r from-gray-50 to-slate-50 border-gray-200";default:return"bg-white border-gray-200"}})(e.color),children:[t.jsx(c.Ol,{className:"pb-3",children:(0,t.jsxs)(c.ll,{className:`text-lg font-bold flex items-center gap-3 ${(e=>{switch(e){case"blue":return"text-blue-800";case"green":return"text-green-800";case"purple":return"text-purple-800";case"yellow":return"text-yellow-800";case"red":return"text-red-800";default:return"text-foreground"}})(e.color)}`,children:[t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${"blue"===e.color?"bg-blue-100":"green"===e.color?"bg-green-100":"purple"===e.color?"bg-purple-100":"yellow"===e.color?"bg-yellow-100":"red"===e.color?"bg-red-100":(e.color,"bg-gray-100")}`,children:t.jsx("div",{className:`${"blue"===e.color?"text-blue-600":"green"===e.color?"text-green-600":"purple"===e.color?"text-purple-600":"yellow"===e.color?"text-yellow-600":"red"===e.color?"text-red-600":(e.color,"text-gray-600")}`,children:e.icon})}),e.title]})}),t.jsx(c.aY,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.fields.map((e,s)=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[e.icon,t.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:e.label})]}),t.jsx("div",{className:"text-sm",children:o(e.value,e.type)})]},s))})})]},s))}),d&&t.jsx(t.Fragment,{children:t.jsx("div",{className:"border-t pt-4",children:t.jsx("div",{className:"flex justify-end gap-2",children:d})})})]})})}}};