(()=>{var e={};e.id=9069,e.ids=[9069],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},39713:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>c}),t(70255),t(22834),t(62510),t(35866);var r=t(23191),s=t(88716),l=t(37922),n=t.n(l),i=t(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(a,o);let c=["",{children:["dashboard",{children:["work-orders",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,70255)),"D:\\APP\\deer-lab\\src\\app\\dashboard\\work-orders\\create\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,22834)),"D:\\APP\\deer-lab\\src\\app\\dashboard\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,62510)),"D:\\APP\\deer-lab\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["D:\\APP\\deer-lab\\src\\app\\dashboard\\work-orders\\create\\page.tsx"],m="/dashboard/work-orders/create/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/dashboard/work-orders/create/page",pathname:"/dashboard/work-orders/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},52792:(e,a,t)=>{Promise.resolve().then(t.bind(t,67029))},86333:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},72257:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]])},30361:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},77506:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},83855:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},50949:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3634:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},67029:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>M});var r=t(10326),s=t(17577),l=t(35047),n=t(76),i=t(90445),o=t(85999),c=t(86333),d=t(48705),m=t(30361);let u=(0,t(62881).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var x=t(72257),g=t(3634),h=t(50949),f=t(77506),p=t(83855),b=t(49527),N=t(91664),j=t(29752),y=t(41190),v=t(44794),w=t(29280),k=t(41156),S=t(38443);function M(){let e=(0,l.useRouter)(),[a,t]=(0,s.useState)([]),[M,C]=(0,s.useState)([]),[A,_]=(0,s.useState)([]),[P,E]=(0,s.useState)(null),[Z,q]=(0,s.useState)(1),[G,I]=(0,s.useState)(!0),[R,D]=(0,s.useState)(!1),[L,T]=(0,s.useState)(""),O=e=>e%1==0?e.toString():e.toFixed(3),z=a.filter(e=>e.name.toLowerCase().includes(L.toLowerCase())||e.code.toLowerCase().includes(L.toLowerCase())||e.seriesName&&e.seriesName.toLowerCase().includes(L.toLowerCase())).sort((e,a)=>{let t=e.seriesName||"未指定",r=a.seriesName||"未指定";return t!==r?t.localeCompare(r,"zh-TW"):e.name.localeCompare(a.name,"zh-TW")}),V=()=>{if(!P||!M.length||!A.length)return console.log("缺少必要資料:",{hasSelectedProduct:!!P,materialsCount:M.length,fragrancesCount:A.length,selectedProduct:P,materials:M,fragrances:A}),[];console.log("計算物料需求:",{selectedProduct:{id:P.id,name:P.name,fragranceName:P.fragranceName,fragranceCode:P.fragranceCode,specificMaterialNames:P.specificMaterialNames,commonMaterialNames:P.commonMaterialNames},materialsCount:M.length,fragrancesCount:A.length,targetQuantity:Z});let e=new Map;if(!P.fragranceFormula)return console.error("錯誤：沒有香精配方資料"),o.Am.error("抓取錯誤：沒有香精配方資料"),[];let{percentage:a,pgRatio:t,vgRatio:r}=P.fragranceFormula;if(console.log("香精配方資料:",{percentage:a,pgRatio:t,vgRatio:r}),!a||a<=0)return console.error("錯誤：香精比例為0或無效"),o.Am.error("抓取錯誤：香精比例為0或無效"),[];let s={fragrance:a,pg:t,vg:r};if(console.log("直接使用香精詳情中的配方比例（避免浮點數精度問題）:",{香精:a+"%",PG:t+"%",VG:r+"%",總計:a+t+r+"%"}),console.log("使用香精比例:",s),P.fragranceName&&"未指定"!==P.fragranceName){let a=s.fragrance/100*Z,t=A.find(e=>e.code===P.fragranceCode||e.name===P.fragranceName||e.name.includes(P.fragranceName)||P.fragranceCode&&e.code.includes(P.fragranceCode));console.log("香精匹配結果:",{fragranceCode:P.fragranceCode,fragranceName:P.fragranceName,foundFragrance:t?{id:t.id,code:t.code,name:t.name,currentStock:t.currentStock}:null,allFragrances:A.map(e=>({code:e.code,name:e.name,currentStock:e.currentStock}))});let r=t&&t.currentStock||0,l=r>=a;e.set("fragrance",{materialId:t?t.id:"fragrance",materialCode:P.fragranceCode,materialName:P.fragranceName,requiredQuantity:a,currentStock:r,unit:"KG",hasEnoughStock:l,category:"fragrance",ratio:s.fragrance}),console.log("添加香精:",P.fragranceName,a,"比例:",s.fragrance,"庫存:",r,"充足:",l)}let l=(0,b.n)(M,"pg");if(l){let a=s.pg/100*Z;e.set(l.id,{materialId:l.id,materialCode:l.code,materialName:l.name,requiredQuantity:a,currentStock:l.currentStock||0,unit:l.unit||"KG",hasEnoughStock:(l.currentStock||0)>=a,category:"pg",ratio:s.pg}),console.log("添加PG:",l.name,a,"比例:",s.pg)}else console.warn("找不到PG物料");let n=(0,b.n)(M,"vg");if(n){let a=s.vg/100*Z;e.set(n.id,{materialId:n.id,materialCode:n.code,materialName:n.name,requiredQuantity:a,currentStock:n.currentStock||0,unit:n.unit||"KG",hasEnoughStock:(n.currentStock||0)>=a,category:"vg",ratio:s.vg}),console.log("添加VG:",n.name,a,"比例:",s.vg)}else console.warn("找不到VG物料");let i=(0,b.n)(M,"nicotine");if(i){let a=P.nicotineMg&&P.nicotineMg>0?Z*P.nicotineMg/250:0;e.set(i.id,{materialId:i.id,materialCode:i.code,materialName:i.name,requiredQuantity:a,currentStock:i.currentStock||0,unit:i.unit||"KG",hasEnoughStock:(i.currentStock||0)>=a,category:"nicotine",ratio:0}),console.log("添加尼古丁:",i.name,a,"濃度:",P.nicotineMg)}console.log("專屬材料名稱:",P.specificMaterialNames),P.specificMaterialNames&&P.specificMaterialNames.length>0&&P.specificMaterialNames.forEach(a=>{let t=M.find(e=>e.name===a);if(console.log("專屬材料匹配:",{materialName:a,foundMaterial:t?{id:t.id,code:t.code,name:t.name}:null}),t){let a=0,r=t.unit||"個";t.name.includes("包裝")||t.name.includes("盒")||t.name.includes("貼紙")||t.name.includes("底座")||t.name.includes("空倉")||t.name.includes("小塞")?(a=Z,r="個"):(a=Z,r=t.unit||"個"),e.set(t.id,{materialId:t.id,materialCode:t.code,materialName:t.name,requiredQuantity:a,currentStock:t.currentStock||0,unit:r,hasEnoughStock:(t.currentStock||0)>=a,category:"specific",ratio:1}),console.log("添加專屬材料:",t.name,a,r)}else console.log("找不到專屬材料:",a)}),console.log("通用材料名稱:",P.commonMaterialNames),P.commonMaterialNames&&P.commonMaterialNames.length>0&&P.commonMaterialNames.forEach(a=>{let t=M.find(e=>e.name===a);if(t){let a=0,r=t.unit||"個";t.name.includes("包裝")||t.name.includes("盒")||t.name.includes("貼紙")||t.name.includes("底座")||t.name.includes("空倉")||t.name.includes("小塞")?(a=Z,r="個"):(a=Z,r=t.unit||"個"),e.set(t.id,{materialId:t.id,materialCode:t.code,materialName:t.name,requiredQuantity:a,currentStock:t.currentStock||0,unit:r,hasEnoughStock:(t.currentStock||0)>=a,category:"common",ratio:1}),console.log("添加通用材料:",t.name,a,r)}else console.log("找不到通用材料:",a)});let c=Array.from(e.values());return c.sort((e,a)=>{let t=["fragrance","pg","vg","nicotine","specific","common","other"],r=t.indexOf(e.category||"other"),s=t.indexOf(a.category||"other");return r!==s?r-s:(e.materialName||"").localeCompare(a.materialName||"")}),console.log("最終物料需求:",c),c},Q=()=>{let e=new Date,a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),s=Math.floor(1e3*Math.random()).toString().padStart(3,"0");return`WO-${a}${t}${r}-${s}`},F=async()=>{if(!P){o.Am.error("請選擇產品");return}if(Z<=0){o.Am.error("請輸入有效的目標產量");return}let a=V(),t=a.filter(e=>["fragrance","pg","vg","nicotine"].includes(e.category)&&!e.hasEnoughStock);if(t.length>0){o.Am.error(`以下核心物料庫存不足：${t.map(e=>e.materialName).join(", ")}`);return}D(!0);try{let t=Q(),r={code:t,productRef:(0,n.doc)(i.db,"products",P.id),productSnapshot:{code:P.code,name:P.name,seriesName:P.seriesName,fragranceName:P.fragranceName,fragranceCode:P.fragranceCode,nicotineMg:P.nicotineMg},billOfMaterials:a.map(e=>({id:e.materialId,name:e.materialName,code:e.materialCode,type:"fragrance"===e.category?"fragrance":"material",quantity:["fragrance","pg","vg","nicotine"].includes(e.category)?e.requiredQuantity:0,unit:e.unit,ratio:e.ratio||0,isCalculated:!0,category:e.category,usedQuantity:0})),targetQuantity:Z,actualQuantity:0,status:"預報",qcStatus:"未檢驗",createdAt:new Date,createdByRef:null,updatedAt:new Date},s=await (0,n.addDoc)((0,n.collection)(i.db,"workOrders"),r);o.Am.success(`工單 ${t} 建立成功`),e.push(`/dashboard/work-orders/${s.id}`)}catch(e){console.error("建立工單失敗:",e),o.Am.error("建立工單失敗")}finally{D(!1)}},$=V(),K=$.some(e=>["fragrance","pg","vg","nicotine"].includes(e.category)&&!e.hasEnoughStock);return G?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"w-16 h-16 border-4 border-slate-200 rounded-full animate-spin"}),r.jsx("div",{className:"absolute top-0 left-0 w-16 h-16 border-4 border-transparent border-t-blue-600 rounded-full animate-spin"})]}),r.jsx("p",{className:"text-slate-600 mt-6 font-medium text-lg",children:"載入中..."}),r.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"正在準備工單建立環境"})]})}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,r.jsxs)(N.z,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"hover:bg-white/80 backdrop-blur-sm transition-all duration-200",children:[r.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"返回"]}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 bg-clip-text text-transparent",children:"建立新工單"}),r.jsx("p",{className:"text-gray-600 mt-2 text-lg font-medium",children:"選擇產品並設定生產參數"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"xl:col-span-1 space-y-6",children:[(0,r.jsxs)(j.Zb,{className:"shadow-lg border-0 bg-white",children:[(0,r.jsxs)(j.Ol,{className:"bg-gradient-to-r from-blue-200 to-blue-300 text-blue-800 rounded-t-xl",children:[(0,r.jsxs)(j.ll,{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(d.Z,{className:"h-5 w-5 text-blue-600"})}),"產品選擇"]}),r.jsx(j.SZ,{className:"text-blue-700",children:"選擇要生產的產品"})]}),(0,r.jsxs)(j.aY,{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx(v._,{htmlFor:"product",className:"text-sm font-semibold text-gray-700 mb-3 block",children:"產品"}),(0,r.jsxs)(w.Ph,{onValueChange:e=>{E(a.find(a=>a.id===e)||null)},children:[r.jsx(w.i4,{className:"h-12 border-2 border-gray-200 hover:border-blue-300 focus:border-blue-500 transition-all duration-200 bg-white",children:r.jsx(w.ki,{placeholder:"選擇要生產的產品"})}),r.jsx(w.Bw,{children:z.map(e=>r.jsx(w.Ql,{value:e.id,children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("span",{className:"font-medium",children:["[",e.seriesName||"未指定","] - ",e.name]}),r.jsx("span",{className:"text-xs text-slate-500",children:e.code})]})},e.id))})]})]}),P&&(0,r.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4",children:[(0,r.jsxs)("h4",{className:"font-semibold mb-4 text-green-800 flex items-center gap-2",children:[r.jsx(m.Z,{className:"h-4 w-4"}),"產品資訊"]}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"產品系列："}),r.jsx("span",{className:"font-semibold text-gray-800",children:P.seriesName})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"產品名稱："}),r.jsx("span",{className:"font-semibold text-gray-800",children:P.name})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"產品代號："}),r.jsx("span",{className:"font-semibold text-gray-800",children:P.code})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"香精："}),r.jsx("span",{className:"font-semibold text-gray-800",children:P.fragranceName})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"尼古丁濃度："}),(0,r.jsxs)("span",{className:"font-semibold text-gray-800",children:[P.nicotineMg," mg/ml"]})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx(v._,{htmlFor:"targetQuantity",className:"text-sm font-semibold text-gray-700 mb-3 block",children:"目標產量 (KG)"}),r.jsx(y.I,{type:"number",value:Z,onChange:e=>q(Number(e.target.value)),placeholder:"1",min:"1",className:"h-12 border-2 border-gray-200 hover:border-blue-300 focus:border-blue-500 transition-all duration-200 bg-white"})]})]})]}),(0,r.jsxs)(j.Zb,{className:"shadow-lg border-0 bg-white",children:[(0,r.jsxs)(j.Ol,{className:"bg-gradient-to-r from-purple-200 to-purple-300 text-purple-800 rounded-t-xl",children:[(0,r.jsxs)(j.ll,{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:r.jsx(u,{className:"h-5 w-5 text-purple-600"})}),"工單資訊"]}),r.jsx(j.SZ,{className:"text-purple-700",children:"工單基本資訊"})]}),r.jsx(j.aY,{className:"p-6",children:r.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium text-gray-600",children:"工單號碼："}),r.jsx("span",{className:"font-bold text-purple-700 text-lg font-mono",children:Q()})]})})})]})]}),r.jsx("div",{className:"xl:col-span-2",children:(0,r.jsxs)(j.Zb,{className:"shadow-lg border-0 bg-white",children:[(0,r.jsxs)(j.Ol,{className:"bg-gradient-to-r from-orange-200 to-orange-300 text-orange-800 rounded-t-xl",children:[(0,r.jsxs)(j.ll,{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:r.jsx(x.Z,{className:"h-5 w-5 text-orange-600"})}),"物料需求分析"]}),(0,r.jsxs)(j.SZ,{className:"text-orange-700",children:["基於目標產量 ",Z,"KG 的物料需求"]})]}),r.jsx(j.aY,{className:"p-6",children:P?(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-bold text-xl mb-6 text-blue-700 border-b-2 border-blue-200 pb-4 flex items-center gap-3",children:[r.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),r.jsx(g.Z,{className:"h-5 w-5"}),"核心液體 (按香精配方比例)"]}),r.jsx("div",{className:"overflow-hidden rounded-xl border border-gray-200 shadow-lg",children:(0,r.jsxs)(k.iA,{children:[r.jsx(k.xD,{children:(0,r.jsxs)(k.SC,{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:[r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"物料代號"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"物料名稱"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"需求量 (KG)"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"當前庫存"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"狀態"})]})}),r.jsx(k.RM,{children:$.filter(e=>["fragrance","pg","vg","nicotine"].includes(e.category)).map((e,a)=>(0,r.jsxs)(k.SC,{className:"hover:bg-gray-50/50 transition-all duration-200",children:[r.jsx(k.pj,{className:"font-semibold text-gray-800",children:e.materialCode}),r.jsx(k.pj,{className:"font-medium text-gray-700",children:e.materialName}),(0,r.jsxs)(k.pj,{className:"font-bold text-blue-600 text-lg",children:[O(e.requiredQuantity)," ",e.unit]}),(0,r.jsxs)(k.pj,{className:"text-gray-600",children:[e.currentStock," ",e.unit]}),r.jsx(k.pj,{children:e.hasEnoughStock?(0,r.jsxs)(S.C,{className:"bg-green-100 text-green-800 border border-green-300 font-semibold",children:[r.jsx(m.Z,{className:"h-3 w-3 mr-1"}),"庫存充足"]}):(0,r.jsxs)(S.C,{variant:"destructive",className:"font-semibold",children:[r.jsx(h.Z,{className:"h-3 w-3 mr-1"}),"庫存不足"]})})]},a))})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-bold text-xl mb-6 text-gray-700 border-b-2 border-gray-200 pb-4 flex items-center gap-3",children:[r.jsx("div",{className:"w-4 h-4 bg-gray-500 rounded-full"}),r.jsx(d.Z,{className:"h-5 w-5"}),"其他材料 (手動配置使用數量)"]}),r.jsx("div",{className:"overflow-hidden rounded-xl border border-gray-200 shadow-lg",children:(0,r.jsxs)(k.iA,{children:[r.jsx(k.xD,{children:(0,r.jsxs)(k.SC,{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:[r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"物料代號"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"物料名稱"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"當前庫存"}),r.jsx(k.ss,{className:"text-gray-700 font-bold",children:"狀態"})]})}),r.jsx(k.RM,{children:$.filter(e=>!["fragrance","pg","vg","nicotine"].includes(e.category)).map((e,a)=>(0,r.jsxs)(k.SC,{className:"hover:bg-gray-50/50 transition-all duration-200",children:[r.jsx(k.pj,{className:"font-semibold text-gray-800",children:e.materialCode}),r.jsx(k.pj,{className:"font-medium text-gray-700",children:e.materialName}),(0,r.jsxs)(k.pj,{className:"text-gray-600",children:[e.currentStock," ",e.unit]}),r.jsx(k.pj,{children:(0,r.jsxs)(S.C,{className:"bg-blue-100 text-blue-800 border border-blue-300 font-semibold",children:[r.jsx(d.Z,{className:"h-3 w-3 mr-1"}),"手動配置"]})})]},a))})]})})]}),r.jsx("div",{className:"pt-6",children:r.jsx(N.z,{onClick:F,disabled:!P||K||R,className:"w-full h-16 text-xl font-bold bg-gradient-to-r from-green-400 to-emerald-500 hover:from-green-500 hover:to-emerald-600 text-white shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",size:"lg",children:R?(0,r.jsxs)(r.Fragment,{children:[r.jsx(f.Z,{className:"mr-3 h-6 w-6 animate-spin"}),"建立中..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(p.Z,{className:"mr-3 h-6 w-6"}),"建立工單"]})})})]}):(0,r.jsxs)("div",{className:"text-center py-16",children:[r.jsx("div",{className:"w-32 h-32 mx-auto mb-8 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-full flex items-center justify-center",children:r.jsx(d.Z,{className:"h-16 w-16 text-blue-600"})}),r.jsx("h3",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"請選擇產品"}),r.jsx("p",{className:"text-gray-500 text-lg",children:"選擇產品後將顯示詳細的物料需求分析"})]})})]})})]})]})})}},29752:(e,a,t)=>{"use strict";t.d(a,{Ol:()=>n,SZ:()=>o,Zb:()=>l,aY:()=>c,eW:()=>d,ll:()=>i});var r=t(10326);t(17577);var s=t(51223);function l({className:e,...a}){return r.jsx("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-lg border-2 p-6 shadow-md",e),...a})}function n({className:e,...a}){return r.jsx("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 has-data-[slot=card-action]:grid-cols-[1fr_auto]",e),...a})}function i({className:e,...a}){return r.jsx("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...a})}function o({className:e,...a}){return r.jsx("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}function c({className:e,...a}){return r.jsx("div",{"data-slot":"card-content",className:(0,s.cn)("",e),...a})}function d({className:e,...a}){return r.jsx("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center",e),...a})}},41190:(e,a,t)=>{"use strict";t.d(a,{I:()=>n});var r=t(10326),s=t(17577),l=t(51223);let n=s.forwardRef(({className:e,type:a,...t},s)=>r.jsx("input",{type:a,className:(0,l.cn)("flex w-full rounded-md border border-slate-200 bg-white px-3 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300","h-11 sm:h-10 py-3 sm:py-2","text-base sm:text-sm","min-h-[44px]",e),ref:s,...t}));n.displayName="Input"},44794:(e,a,t)=>{"use strict";t.d(a,{_:()=>n});var r=t(10326);t(17577);var s=t(34478),l=t(51223);function n({className:e,...a}){return r.jsx(s.f,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}},29280:(e,a,t)=>{"use strict";t.d(a,{Bw:()=>h,Ph:()=>d,Ql:()=>f,i4:()=>u,ki:()=>m});var r=t(10326),s=t(17577),l=t(38785),n=t(941),i=t(96633),o=t(32933),c=t(51223);let d=l.fC;l.ZA;let m=l.B4,u=s.forwardRef(({className:e,children:a,...t},s)=>(0,r.jsxs)(l.xz,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus:ring-slate-300",e),...t,children:[a,r.jsx(l.JO,{asChild:!0,children:r.jsx(n.Z,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=l.xz.displayName;let x=s.forwardRef(({className:e,...a},t)=>r.jsx(l.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:r.jsx(i.Z,{className:"h-4 w-4"})}));x.displayName=l.u_.displayName;let g=s.forwardRef(({className:e,...a},t)=>r.jsx(l.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:r.jsx(n.Z,{className:"h-4 w-4"})}));g.displayName=l.$G.displayName;let h=s.forwardRef(({className:e,children:a,position:t="popper",...s},n)=>r.jsx(l.h_,{children:(0,r.jsxs)(l.VY,{ref:n,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-white text-slate-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[r.jsx(x,{}),r.jsx(l.l_,{className:(0,c.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),r.jsx(g,{})]})}));h.displayName=l.VY.displayName,s.forwardRef(({className:e,...a},t)=>r.jsx(l.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a})).displayName=l.__.displayName;let f=s.forwardRef(({className:e,children:a,...t},s)=>(0,r.jsxs)(l.ck,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-slate-50",e),...t,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(l.wU,{children:r.jsx(o.Z,{className:"h-4 w-4"})})}),r.jsx(l.eT,{children:a})]}));f.displayName=l.ck.displayName,s.forwardRef(({className:e,...a},t)=>r.jsx(l.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-slate-100 dark:bg-slate-800",e),...a})).displayName=l.Z0.displayName},41156:(e,a,t)=>{"use strict";t.d(a,{RM:()=>i,SC:()=>o,iA:()=>l,pj:()=>d,ss:()=>c,xD:()=>n});var r=t(10326);t(17577);var s=t(51223);function l({className:e,...a}){return r.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:r.jsx("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...a})})}function n({className:e,...a}){return r.jsx("thead",{"data-slot":"table-header",className:(0,s.cn)("",e),...a})}function i({className:e,...a}){return r.jsx("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...a})}function o({className:e,...a}){return r.jsx("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b border-border transition-colors",e),...a})}function c({className:e,...a}){return r.jsx("th",{"data-slot":"table-head",className:(0,s.cn)("bg-muted text-foreground font-semibold border-b border-border p-3 text-left align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}function d({className:e,...a}){return r.jsx("td",{"data-slot":"table-cell",className:(0,s.cn)("p-3 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}},49527:(e,a,t)=>{"use strict";t.d(a,{n:()=>s});let r={PG_MATERIAL_CODES:["UV3404503","PG"],VG_MATERIAL_CODES:["UV3400698","VG"],NICOTINE_MATERIAL_CODES:["UV3405520","NIC","丁鹽","尼古丁"],PG_MATERIAL_NAMES:["PG丙二醇","PG","丙二醇"],VG_MATERIAL_NAMES:["VG甘油","VG","甘油"],NICOTINE_MATERIAL_NAMES:["丁鹽","尼古丁","NicSalt"]},s=(e,a)=>e.find(e=>{let t=e.code?.toUpperCase()||"",s=e.name||"";switch(a){case"pg":return r.PG_MATERIAL_CODES.some(e=>t.includes(e))||r.PG_MATERIAL_NAMES.some(e=>s.includes(e));case"vg":return r.VG_MATERIAL_CODES.some(e=>t.includes(e))||r.VG_MATERIAL_NAMES.some(e=>s.includes(e));case"nicotine":return r.NICOTINE_MATERIAL_CODES.some(e=>t.includes(e))||r.NICOTINE_MATERIAL_NAMES.some(e=>s.includes(e));default:return!1}})},70255:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`D:\APP\deer-lab\src\app\dashboard\work-orders\create\page.tsx#default`)},34478:(e,a,t)=>{"use strict";t.d(a,{f:()=>i});var r=t(17577),s=t(45226),l=t(10326),n=r.forwardRef((e,a)=>(0,l.jsx)(s.WV.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));n.displayName="Label";var i=n}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[8948,9654,5540,8693,692,4108,4334],()=>t(39713));module.exports=r})();