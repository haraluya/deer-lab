# 香精管理頁面更新部署指南

## 更新內容

本次更新對香精管理頁面進行了以下重要修改：

### 1. 香精對話框更新
- 將「狀態」欄位改為「香精種類」
- 香精種類選項：棉芯、陶瓷芯、棉陶芯通用
- 移除主分類、細分分類、建立人員欄位
- 單位固定為 KG，不需要選擇

### 2. 香精詳情頁面更新
- 四個基本資訊欄位調整為：
  1. 香精名稱
  2. 香精編號
  3. 使用產品列表（超過三個顯示...）
  4. 供應商
- 將「價格資訊」改為「配方欄位」
- 配方欄位顯示：香精比例、PG比例、VG比例、總比例

### 3. 匯入/匯出功能更新
- 添加更新資料模式支援
- 使用香精編號作為更新識別符
- 支援批量更新現有香精資料

### 4. 後端 API 更新
- 新增 `updateFragranceByCode` 函數
- 更新現有函數以支援 `fragranceType` 欄位
- 固定單位為 KG

## 部署步驟

### 1. 部署 Firebase Functions
```bash
cd functions
npm run build
firebase deploy --only functions
```

### 2. 部署前端應用
```bash
npm run build
firebase deploy --only hosting
```

### 3. 驗證部署
1. 訪問香精管理頁面
2. 測試新增香精功能
3. 測試編輯香精功能
4. 測試匯入/匯出功能（包括更新模式）
5. 檢查香精詳情頁面顯示

## 注意事項

1. **資料遷移**：現有的香精資料中的 `status` 欄位會自動映射到 `fragranceType`
2. **向後相容性**：系統會自動處理舊資料格式
3. **單位統一**：所有香精的單位都固定為 KG

## 測試清單

- [ ] 新增香精功能正常
- [ ] 編輯香精功能正常
- [ ] 香精種類下拉選單顯示正確
- [ ] 香精詳情頁面顯示正確
- [ ] 匯入功能正常（新增模式）
- [ ] 匯入功能正常（更新模式）
- [ ] 匯出功能正常
- [ ] 搜尋功能正常
- [ ] 手機版顯示正常

## 回滾方案

如果部署後發現問題，可以：

1. 回滾到上一個版本
2. 檢查 Firebase Functions 日誌
3. 檢查瀏覽器控制台錯誤
4. 驗證資料庫結構

## 聯繫支援

如有問題，請檢查：
1. Firebase Functions 日誌
2. 瀏覽器開發者工具
3. 網路請求狀態
